<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title id="page-title">Chains - Only at The Kiosk</title>
  <meta content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover, user-scalable=yes" name="viewport">
  
  <!-- Swiper CSS (kept for carousel) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
  
  <!-- Main Stylesheet (contains theme variables) -->
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/onlyatthekiosk.css" rel="stylesheet" type="text/css">
  
  <!-- Navigation CSS -->
  <link href="../css/navigation.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  
  <!-- Lenis Smooth Scroll CSS -->
  <link rel="stylesheet" href="https://unpkg.com/lenis@1.3.15/dist/lenis.css">
  
  <!-- Initialize theme immediately before page renders -->
  <script>
    // Initialize theme immediately to prevent flash of unstyled content
    (function() {
      try {
        var savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
      } catch(e) {
        // Fallback if localStorage is not available
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
  
  <!-- Custom Styles -->
  <style>
    /*
    ========================================
    CONTAINER BORDER DEBUGGING SYSTEM
    ========================================
    
    How to Enable Debug Borders:
    1. Via Console: Run toggleDebugBorders()
    2. Via URL: Add ?debug=borders to the page URL
    3. Via HTML class: Add class="debug-borders" to <html> element
    
    Quick Color Reference:
    - Red (#FF0000): navbar
    - Dark Red (#CC0000): navbar-content-wrapper
    - Orange (#FF6600): navbar-left
    - Coral (#FF7F50): navbar-right
    - Salmon (#FA8072): navbar-right-content-wrapper
    - Light Salmon (#FFA07A): navbar-right-content
    - Maroon (#800000): page-padding
    - Blue (#0000FF): carousel_component
    - Dark Blue (#0000CC): carousel_wrap
    - Navy (#000080): carousel_list
    - Teal (#008080): carousel_item
    - Cyan (#00FFFF): carousel_arrow_wrap
    - Green (#00FF00): .swiper (main)
    - Dark Green (#00CC00): .swiper-wrapper
    - Lime (#32CD32): .swiper-slide
    - Purple (#800080): collection-title
    - Violet (#8A2BE2): collection-title-text
    - Magenta (#FF00FF): products_collection-drawer
    - Dark Magenta (#CC00CC): products_drawer-wrapper
    - Fuchsia (#FF00CC): products_drawer-content
    - Hot Pink (#FF69B4): products_drawer-images
    - Pink (#FFC0CB): products_drawer-text
    - Gold (#FFD700): promo-slider
    - Yellow (#FFFF00): promo-card
    - Khaki (#F0E68C): promo-slider-nav
    
    See docs/CONTAINER_BORDERS_CHEATSHEET.md for complete documentation.
    ========================================
    */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100vh;
      overflow-x: hidden; /* Prevent horizontal scroll */
      overflow-y: auto; /* Allow vertical scrolling */
      position: relative; /* Allow normal document flow */
      font-family: 'Generalsans Variable', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background-color 0.3s ease, color 0.3s ease;
      overscroll-behavior: none;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      /* Allow touch scrolling */
      touch-action: pan-y pan-x;
      -webkit-overflow-scrolling: touch;
    }

    /* Collection Title Styles */
    .collection-title {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      pointer-events: none;
      opacity: 1;
    }
    
    .collection-title-text {
      font-size: 4rem;
      font-weight: 700;
      color: var(--text-primary);
      text-align: center;
      margin: 0;
      font-family: 'Suisseintl', sans-serif;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: color 0.3s ease;
      white-space: nowrap;
    }
    
    /* Product title: orange in light mode */
    [data-theme="light"] .collection-title-text {
      color: var(--accent-orange, #FF6600);
    }
    
    [data-theme="dark"] .collection-title-text {
      color: var(--text-primary-dark, #fff);
    }
    
    /* Responsive collection title */
    @media screen and (max-width: 991px) {
      .collection-title-text {
        font-size: 3rem;
      }
    }
    
    @media screen and (max-width: 767px) {
      .collection-title-text {
        font-size: 2.5rem;
      }
    }
    
    @media screen and (max-width: 479px) {
      .collection-title-text {
        font-size: 2rem;
      }
    }
    
    /* Fade-up elements start hidden */
    [fade-up], [carousel="wrap"] { 
      opacity: 0;
    }

    /* 3D Carousel Container */
    [carousel="component"] {
      position: relative;
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1.5rem 1rem;
      box-sizing: border-box;
      overflow: visible; /* Allow 3D carousel items to extend beyond bounds */
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background-color 0.3s ease, color 0.3s ease;
      /* Allow touch gestures for swiping and scrolling */
      touch-action: pan-y pan-x;
      /* Keep container centered */
      margin: 0;
    }

    /* Tablet - Adjust padding */
    @media screen and (max-width: 991px) {
      [carousel="component"] {
        padding: 0.75rem;
      }
    }

    /* Mobile - Minimal padding */
    @media screen and (max-width: 767px) {
      [carousel="component"] {
        padding: 0.5rem;
        height: 100svh; /* Small viewport height for mobile */
      }
    }

    @media screen and (max-width: 479px) {
      [carousel="component"] {
        padding: 0.25rem;
      }
    }

    /* 3D Carousel Wrapper */
    [carousel="wrap"] {
      will-change: contents;
      --3d-carousel-item-width: 40vw;
      --3d-carousel-gap: 7vw;
      --3d-carousel-rotate: 0deg;
      --3d-carousel-rotate-x: 0deg;
      --3d-carousel-z: 0px;
      position: relative;
      width: 100%;
      max-width: 100%;
      height: 50vh;
      max-height: 50vh;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      perspective-origin: center center;
      box-sizing: border-box;
      overflow: visible; /* Allow 3D items to extend beyond bounds */
      /* Allow touch gestures - Swiper handles its own touch events */
      touch-action: pan-y pan-x;
      -webkit-user-select: none;
      user-select: none;
      /* Keep carousel centered */
      left: 0;
      right: 0;
      margin-left: auto;
      margin-right: auto;
    }

    /* Tablet Responsive */
    @media screen and (max-width: 991px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 70vw;
        --3d-carousel-gap: 6vw;
        height: 45vh;
        max-height: 45vh;
        margin-bottom: 1.25rem;
      }
    }

    /* Mobile - Smaller carousel items */
    @media screen and (max-width: 767px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 80vw;
        --3d-carousel-gap: 5vw;
        height: 40vh;
        max-height: 40vh;
        margin-bottom: 1rem;
      }
    }

    /* Small Mobile */
    @media screen and (max-width: 479px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 85vw;
        --3d-carousel-gap: 4vw;
        height: 35vh;
        max-height: 35vh;
        margin-bottom: 0.75rem;
      }
    }

    /* 3D Transform Container */
    [carousel="wrap"] > div {
      transform-style: preserve-3d;
      transform: translate3d(0px, 0px, var(--3d-carousel-z)) rotateX(var(--3d-carousel-rotate-x)) rotateY(var(--3d-carousel-rotate));
      width: 100%;
      height: 100%;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      transform-origin: center center;
      /* Allow touch interactions - Swiper handles its own */
      touch-action: pan-y pan-x;
      -webkit-user-select: none;
      user-select: none;
      /* Ensure container stays centered */
      margin-left: auto;
      margin-right: auto;
      /* Allow 3D items to extend beyond bounds */
      overflow: visible;
    }

    /* Individual Item Container */
    [carousel="wrap"] > div > div {
      width: var(--3d-carousel-item-width);
      position: absolute;
      transform-origin: center center;
    }

    /* Carousel List */
    .carousel_list {
      list-style: none;
      width: 100%;
      height: 100%;
      /* Prevent touch events from moving the carousel */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      pointer-events: none;
      position: relative;
      overflow: visible; /* Allow 3D items to extend beyond bounds */
    }

    /* Carousel Item */
    .carousel_item {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-origin: center center;
      top: 0;
      left: 0;
      /* Prevent touch events from moving the carousel */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      pointer-events: none;
      overflow: visible; /* Ensure content isn't clipped */
    }

    /* Carousel Image */
    .carousel_img {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      /* Prevent image drag and touch interactions on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: none;
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-tap-highlight-color: transparent;
      /* Ensure image is visible */
      opacity: 1;
      visibility: visible;
      /* Ensure image renders */
      will-change: transform;
    }

    @media screen and (max-width: 479px) {
      .carousel_img {
        border-radius: 8px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
      }
    }

    /* Carousel Ratio (for aspect ratio) */
    .carousel_ratio {
      padding-bottom: 56.25%; /* 16:9 aspect ratio */
      position: relative;
      z-index: 0;
    }

    /* Swiper Container for Titles */
    .swiper {
      width: 100%;
      max-width: 600px;
      height: 180px;
      max-height: 180px;
      margin-bottom: 1rem;
      box-sizing: border-box;
      overflow: visible; /* Allow content to be fully visible */
      /* Enable touch gestures for swiper */
      touch-action: pan-y;
      position: relative;
      z-index: 10000; /* Just below product drawer (10001) but above carousel */
    }
    
    /* Swiper Wrapper - ensure content is visible */
    .swiper-wrapper {
      overflow: visible !important;
      position: relative;
      z-index: 10000;
    }

    .swiper-slide {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 1.5rem 2rem;
      position: relative;
      z-index: 10000;
      box-sizing: border-box;
      /* Prevent text selection during swipe */
      user-select: none;
      -webkit-user-select: none;
      /* Ensure content is fully visible */
      overflow: visible;
    }

    .swiper-slide h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      color: var(--text-primary);
      line-height: 1.2;
      white-space: nowrap; /* Prevent text wrapping */
      overflow: visible; /* Don't clip text */
      text-overflow: clip; /* Show full text */
      transition: color 0.3s ease;
    }
    
    /* Product title: orange in light mode */
    [data-theme="light"] .swiper-slide h2 {
      color: var(--accent-orange, #FF6600);
    }
    
    [data-theme="dark"] .swiper-slide h2 {
      color: var(--text-primary-dark, #fff);
    }

    /* Tablet */
    @media screen and (max-width: 991px) {
      .swiper {
        height: 150px;
        max-height: 150px;
        margin-bottom: 0.75rem;
      }
      
      .swiper-slide {
        padding: 1rem 1.5rem;
      }

      .swiper-slide h2 {
        font-size: 2rem;
      }
    }

    /* Mobile */
    @media screen and (max-width: 767px) {
      .swiper {
        height: 130px;
        max-height: 130px;
        margin-bottom: 0.75rem;
      }

      .swiper-slide {
        padding: 0.75rem 1rem;
      }

      .swiper-slide h2 {
        font-size: 1.75rem;
        margin-bottom: 0.5rem;
      }
    }

    /* Small Mobile */
    @media screen and (max-width: 479px) {
      .swiper {
        height: 120px;
        max-height: 120px;
        margin-bottom: 0.5rem;
      }

      .swiper-slide {
        padding: 0.5rem 0.75rem;
      }

      .swiper-slide h2 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }
    }

    .swiper-slide .button,
    .swiper-slide .view-details-btn {
      padding: 0.75rem 1.5rem;
      background-color: transparent;
      color: var(--text-primary);
      border: 1px solid var(--text-primary);
      text-decoration: none;
      border-radius: 50px;
      font-weight: 500;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      font-family: 'Generalsans Variable', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      /* Touch-friendly button size */
      min-height: 44px;
      min-width: 44px;
      white-space: nowrap;
    }

    .swiper-slide .button:hover,
    .swiper-slide .view-details-btn:hover {
      background-color: var(--text-primary);
      color: var(--bg-primary);
      border-color: var(--text-primary);
      transform: scale(1.02);
    }

    .swiper-slide .button:active,
    .swiper-slide .view-details-btn:active {
      transform: scale(0.98);
    }

    /* Mobile button adjustments */
    @media screen and (max-width: 767px) {
      .swiper-slide .button {
        padding: 8px 20px;
        font-size: 0.8rem;
        min-height: 36px;
      }
    }

    @media screen and (max-width: 479px) {
      .swiper-slide .button {
        padding: 6px 16px;
        font-size: 0.75rem;
        border-radius: 30px;
        min-height: 32px;
      }
    }

    /* Navigation Arrows */
    .carousel_arrow_wrap {
      display: flex;
      gap: 1rem;
      pointer-events: none;
      position: relative;
      z-index: 9999; /* Highest z-index to appear above everything */
    }

    .carousel_arrow_link {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: transparent;
      border: 2px solid var(--text-primary-light, #000);
      border-radius: 50%;
      cursor: pointer;
      pointer-events: auto;
      transition: all 0.3s ease;
      position: relative;
      z-index: 10000; /* Even higher z-index for the buttons themselves */
      /* Touch-friendly size */
      min-width: 44px;
      min-height: 44px;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    /* Day mode (light) - black outline and black arrow */
    [data-theme="light"] .carousel_arrow_link {
      border-color: var(--text-primary-light, #000);
      background-color: transparent;
    }

    /* Night mode (dark) - white outline and white arrow */
    [data-theme="dark"] .carousel_arrow_link {
      border-color: var(--text-primary-dark, #fff);
      background-color: transparent;
    }

    .carousel_arrow_link:hover {
      background-color: var(--text-primary);
      transform: scale(1.1);
    }

    [data-theme="light"] .carousel_arrow_link:hover {
      background-color: var(--text-primary-light, #000);
    }

    [data-theme="dark"] .carousel_arrow_link:hover {
      background-color: var(--text-primary-dark, #fff);
    }

    .carousel_arrow_link:active {
      transform: scale(0.95);
    }

    /* Mobile arrow adjustments */
    @media screen and (max-width: 767px) {
      .carousel_arrow_link {
        width: 50px;
        height: 50px;
      }

      .carousel_arrow_link::before {
        border-width: 6px 10px 6px 0;
      }

      .carousel_arrow_link.is-right::before {
        border-width: 6px 0 6px 10px;
      }
    }

    @media screen and (max-width: 479px) {
      .carousel_arrow_link {
        width: 44px;
        height: 44px;
      }

      .carousel_arrow_wrap {
        gap: 0.5rem;
      }
    }

    .carousel_arrow_link::before {
      content: '';
      width: 0;
      height: 0;
      border-style: solid;
      border-width: 8px 12px 8px 0;
      border-color: transparent var(--text-primary-light, #000) transparent transparent;
      display: block;
      transition: border-color 0.3s ease;
    }

    /* Day mode (light) - black arrow */
    [data-theme="light"] .carousel_arrow_link::before {
      border-color: transparent var(--text-primary-light, #000) transparent transparent;
    }

    /* Night mode (dark) - white arrow */
    [data-theme="dark"] .carousel_arrow_link::before {
      border-color: transparent var(--text-primary-dark, #fff) transparent transparent;
    }

    .carousel_arrow_link.is-right::before {
      border-width: 8px 0 8px 12px;
      border-color: transparent transparent transparent var(--text-primary-light, #000);
    }

    /* Day mode (light) - black arrow */
    [data-theme="light"] .carousel_arrow_link.is-right::before {
      border-color: transparent transparent transparent var(--text-primary-light, #000);
    }

    /* Night mode (dark) - white arrow */
    [data-theme="dark"] .carousel_arrow_link.is-right::before {
      border-color: transparent transparent transparent var(--text-primary-dark, #fff);
    }

    /* Disabled State */
    .swiper-button-disabled {
      pointer-events: none;
      opacity: 0.4;
    }

    /* Product Drawer Styles */
    .products_collection-drawer {
      z-index: 10001 !important; /* Above navbar (z-index: 10000) */
      display: none;
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.6);
      transition: background-color 0.3s ease;
    }
    
    /* Theme-aware drawer overlay */
    [data-theme="light"] .products_collection-drawer {
      background-color: rgba(0, 0, 0, 0.4);
    }
    
    [data-theme="dark"] .products_collection-drawer {
      background-color: rgba(0, 0, 0, 0.7);
    }

    .products_collection-drawer.open {
      display: flex;
    }
    
    /* Ensure drawer text colors use theme variables */
    .products_drawer-wrapper * {
      color: inherit;
    }

    .products_drawer-close {
      flex: 1;
      cursor: pointer;
      z-index: 10002; /* Above drawer wrapper */
    }

    .products_drawer-wrapper {
      border-left: 1px solid var(--border);
      background-color: var(--bg-primary);
      color: var(--text-primary);
      width: 50vw;
      max-width: 600px;
      padding-bottom: 3rem;
      padding-left: 1.5rem;
      padding-right: 3rem;
      overflow-y: auto;
      position: relative;
      z-index: 10003; /* Above drawer close overlay */
      animation: slideInRight 0.3s ease-out;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      /* Improve scrolling on mobile */
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
      }
      to {
        transform: translateX(0);
      }
    }

    @media screen and (max-width: 991px) {
      .products_drawer-wrapper {
        width: 85vw;
        max-width: none;
      }
    }

    @media screen and (max-width: 767px) {
      .products_drawer-wrapper {
        width: 85vw;
        max-width: none;
        padding-left: 1rem;
        padding-right: 1rem;
        padding-bottom: 2rem;
      }
    }

    @media screen and (max-width: 479px) {
      .products_drawer-wrapper {
        width: 100vw;
        padding-left: 0.75rem;
        padding-right: 0.75rem;
        padding-bottom: 1.5rem;
      }

      .products_drawer-title {
        margin-top: 2rem;
        padding-bottom: 0.5rem;
      }

      .products_drawer-title h3 {
        font-size: 1.25rem;
      }
    }

    .products_drawer-close-icon {
      width: 44px;
      height: 44px;
      min-width: 44px;
      min-height: 44px;
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 2rem;
      line-height: 1;
      color: var(--text-primary);
      cursor: pointer;
      z-index: 10004 !important; /* Highest z-index - above everything including navbar */
      transition: opacity 0.3s ease, transform 0.2s ease, color 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      /* Touch-friendly */
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      padding: 0;
    }

    .products_drawer-close-icon:hover {
      opacity: 0.6;
    }

    .products_drawer-close-icon:active {
      transform: scale(0.9);
    }

    .products_drawer-title {
      border-bottom: 1px solid var(--border);
      justify-content: space-between;
      margin-top: 3.5rem;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      display: flex;
      align-items: baseline;
      transition: border-color 0.3s ease;
    }

    .products_drawer-title h3 {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
      color: var(--text-primary);
      transition: color 0.3s ease;
    }

    .products_drawer-title h3:last-child {
      font-weight: 400;
      color: var(--text-secondary);
      transition: color 0.3s ease;
    }

    .products_drawer-content {
      grid-column-gap: 1.5rem;
      grid-row-gap: 1.5rem;
      grid-template-rows: auto;
      grid-template-columns: 1fr 1fr;
      grid-auto-columns: 1fr;
      align-items: start;
      height: auto;
      display: grid;
    }

    @media screen and (max-width: 767px) {
      .products_drawer-content {
        grid-template-columns: 1fr;
        grid-row-gap: 1rem;
      }

      .products_drawer-text {
        position: static;
      }
    }

    .products_drawer-images {
      grid-column-gap: 1.5rem;
      grid-row-gap: 1.5rem;
      grid-template-rows: auto auto;
      grid-template-columns: 1fr;
      grid-auto-columns: 1fr;
      display: grid;
    }

    .products_drawer-main-image {
      object-fit: cover;
      width: 100%;
      height: auto;
      max-height: 22rem;
      border-radius: 8px;
      /* Prevent image drag on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: none;
    }

    @media screen and (max-width: 767px) {
      .products_drawer-main-image {
        max-height: 18rem;
      }
    }

    @media screen and (max-width: 479px) {
      .products_drawer-main-image {
        max-height: 15rem;
      }
    }

    .products_drawer-more-collection {
      grid-column-gap: 1rem;
      grid-row-gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      display: grid;
    }

    .products_drawer-more-item {
      max-height: 100px;
      overflow: hidden;
      border-radius: 4px;
      cursor: pointer;
      transition: opacity 0.3s ease;
    }

    .products_drawer-more-item:hover {
      opacity: 0.7;
    }

    .products_drawer-more-image {
      object-fit: cover;
      width: 100%;
      height: 100%;
      /* Prevent image drag on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: auto;
    }

    @media screen and (max-width: 479px) {
      .products_drawer-more-item {
        max-height: 80px;
      }
    }

    .products_drawer-text {
      padding-top: 1.5rem;
      position: sticky;
      top: 1.5rem;
    }

    .products_quantity-wrapper {
      margin-bottom: 1rem;
    }

    .margin-bottom.margin-xsmall {
      margin-bottom: 0.5rem;
    }

    .uppercase {
      text-transform: uppercase;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: 0.05em;
      transition: color 0.3s ease;
    }

    .products_quantity {
      border: 1px solid var(--border);
      background-color: var(--bg-primary);
      color: var(--text-primary);
      text-align: center;
      border-radius: 4px;
      width: 80px;
      padding: 0.5rem;
      font-size: 1rem;
      transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
    }

    .button-secondary {
      border: 1px solid var(--text-primary);
      background-color: var(--text-primary);
      color: var(--bg-primary);
      text-align: center;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      border-radius: 50px;
      padding: 0.75rem 1.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      font-family: 'Generalsans Variable', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      transition: all 0.3s ease;
      cursor: pointer;
      width: 100%;
      margin-top: 1rem;
      /* Touch-friendly */
      min-height: 44px;
      min-width: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .button-secondary:hover {
      background-color: var(--text-secondary);
      border-color: var(--text-secondary);
      color: var(--bg-primary);
    }

    .button-secondary:active {
      transform: scale(0.98);
    }

    /* Mobile button adjustments */
    @media screen and (max-width: 767px) {
      .button-secondary {
        padding: 0.625rem 1.5rem;
        font-size: 0.8rem;
      }
    }

    .products_text-top {
      border-bottom: 1px solid var(--border);
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      transition: border-color 0.3s ease;
    }

    .products_out-of-stock,
    .products_error {
      background-color: #f5f5f5;
      color: #d32f2f;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }

    .products_text-bottom {
      margin-top: 1.5rem;
    }

    .margin-bottom.margin-medium {
      margin-bottom: 1rem;
    }

    .products_description-item {
      border-bottom: 1px solid var(--border);
      padding-top: 0.75rem;
      padding-bottom: 0.75rem;
      position: relative;
      transition: border-color 0.3s ease;
    }

    .products_description-item:last-child {
      border-bottom: none;
    }

    .products_description-question {
      justify-content: space-between;
      align-items: center;
      padding-top: 0;
      padding-bottom: 0;
      display: flex;
      cursor: pointer;
      /* Touch-friendly */
      min-height: 44px;
      padding: 0.5rem 0;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .products_description-question:hover {
      opacity: 0.7;
    }

    .products_description-question:active {
      opacity: 0.5;
    }

    .products_description-left {
      align-items: center;
      display: flex;
    }

    .products_description-icon {
      width: 1.25rem;
      height: 1.25rem;
      margin-right: 0.5rem;
      font-size: 1.25rem;
      line-height: 1;
    }

    .products_description-question p {
      margin: 0;
      font-weight: 500;
      color: var(--text-primary);
      transition: color 0.3s ease;
    }

    .product_description-plus {
      font-size: 1.5rem;
      font-weight: 300;
      color: var(--text-primary);
      transition: transform 0.3s ease, color 0.3s ease;
      line-height: 1;
    }

    .products_description-item.active .product_description-plus {
      transform: rotate(45deg);
    }

    .products_description-answer {
      display: none;
      padding-top: 0.75rem;
      color: var(--text-secondary);
      transition: color 0.3s ease;
    }

    .products_description-item.active .products_description-answer {
      display: block;
    }

    .products_description-answer .paragraph {
      color: var(--text-secondary);
      line-height: 1.6;
      transition: color 0.3s ease;
    }

    .drawer-loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #fff;
      z-index: 1001;
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .drawer-loading p {
      margin: 0;
      font-size: 0.875rem;
    }

    /*
    ========================================
    DEBUG BORDER SYSTEM - Development Only
    ========================================
    These borders are only visible when html.debug-borders class is present.
    Enable via: toggleDebugBorders() in console or ?debug=borders in URL
    ========================================
    */
    
    /* Debug borders - only active when html.debug-borders is present */
    html.debug-borders .navbar {
      border: 2px solid #FF0000 !important; /* Red - Main navigation */
    }
    
    html.debug-borders .navbar-content-wrapper {
      border: 2px solid #CC0000 !important; /* Dark Red - Nav content wrapper */
    }
    
    html.debug-borders .navbar-left {
      border: 2px solid #FF6600 !important; /* Orange - Nav left section */
    }
    
    html.debug-borders .navbar-right {
      border: 2px solid #FF7F50 !important; /* Coral - Nav right section */
    }
    
    html.debug-borders .navbar-right-content-wrapper {
      border: 2px solid #FA8072 !important; /* Salmon - Nav right content wrapper */
    }
    
    html.debug-borders .navbar-right-content {
      border: 2px solid #FFA07A !important; /* Light Salmon - Nav right content */
    }
    
    html.debug-borders .page-padding {
      border: 2px solid #800000 !important; /* Maroon - Page padding container */
    }
    
    html.debug-borders [carousel="component"] {
      border: 2px solid #0000FF !important; /* Blue - Carousel component */
    }
    
    html.debug-borders [carousel="wrap"] {
      border: 2px solid #0000CC !important; /* Dark Blue - Carousel wrap */
    }
    
    html.debug-borders .carousel_list {
      border: 2px solid #000080 !important; /* Navy - Carousel list */
    }
    
    html.debug-borders .carousel_item {
      border: 2px solid #008080 !important; /* Teal - Carousel item */
    }
    
    html.debug-borders .carousel_arrow_wrap {
      border: 2px solid #00FFFF !important; /* Cyan - Carousel arrow wrap */
    }
    
    html.debug-borders .swiper:not(.promo-slider) {
      border: 2px solid #00FF00 !important; /* Green - Swiper container (main, not promo) */
    }
    
    html.debug-borders .swiper-wrapper:not(.promo-slider .swiper-wrapper) {
      border: 2px solid #00CC00 !important; /* Dark Green - Swiper wrapper */
    }
    
    html.debug-borders .swiper-slide:not(.promo-slider .swiper-slide) {
      border: 2px solid #32CD32 !important; /* Lime - Swiper slide */
    }
    
    html.debug-borders .collection-title {
      border: 2px solid #800080 !important; /* Purple - Collection title */
    }
    
    html.debug-borders .collection-title-text {
      border: 2px solid #8A2BE2 !important; /* Violet - Collection title text */
    }
    
    html.debug-borders .products_collection-drawer {
      border: 2px solid #FF00FF !important; /* Magenta - Product drawer */
    }
    
    html.debug-borders .products_drawer-wrapper {
      border: 2px solid #CC00CC !important; /* Dark Magenta - Drawer wrapper */
    }
    
    html.debug-borders .products_drawer-content {
      border: 2px solid #FF00CC !important; /* Fuchsia - Drawer content */
    }
    
    html.debug-borders .products_drawer-images {
      border: 2px solid #FF69B4 !important; /* Hot Pink - Drawer images */
    }
    
    html.debug-borders .products_drawer-text {
      border: 2px solid #FFC0CB !important; /* Pink - Drawer text */
    }
    
    html.debug-borders .promo-slider {
      border: 2px solid #FFD700 !important; /* Gold - Promo slider */
    }
    
    html.debug-borders .promo-card {
      border: 2px solid #FFFF00 !important; /* Yellow - Promo card */
    }
    
    html.debug-borders .promo-slider-nav {
      border: 2px solid #F0E68C !important; /* Khaki - Promo slider nav */
    }
    
    /* Additional navigation containers */
    html.debug-borders .nav-main-inner {
      border: 2px solid #DC143C !important; /* Crimson - Nav main inner */
    }
    
    html.debug-borders .nav-main-column {
      border: 2px solid #B22222 !important; /* Fire Brick - Nav main column */
    }
    
    html.debug-borders .navbar-left-inner {
      border: 2px solid #FF4500 !important; /* Orange Red - Nav left inner */
    }
    
    html.debug-borders .nav-links-column {
      border: 2px solid #FF6347 !important; /* Tomato - Nav links column */
    }
    
    html.debug-borders .promo-slider .swiper-wrapper {
      border: 2px solid #FFA500 !important; /* Orange - Promo slider wrapper */
    }
    
    html.debug-borders .promo-slider .swiper-slide {
      border: 2px solid #FFD700 !important; /* Gold - Promo slider slide */
    }
  </style>
</head>
<body>
  <!-- Fullscreen Navigation -->
  <div data-collapse="all" data-animation="default" data-duration="0" data-easing2="ease" data-easing="ease" role="banner" class="navbar w-nav">
    <div class="page-padding">
      <div class="nav-main-inner">
        <div class="nav-main-column">
          <div class="nav-main-column-item">
            <div class="nav-main-column-content">
              <div class="scale-on-hover">
                <a href="../index.html" class="brand-wrapper w-inline-block">
                  <span class="special-k">K</span>IOSK
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="nav-main-column">
          <div class="nav-main-column-content">
            <div class="hide-tablet-down">
              <div class="nav-main-column-item">
                <!-- Desktop links can be added here if needed -->
              </div>
            </div>
            <div class="nav-main-column-item">
              <button class="navbar-theme-toggle" aria-label="Toggle theme">
                <span class="navbar-theme-toggle-slider">
                  <svg class="navbar-theme-icon sun" width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="8" cy="8" r="3" fill="currentColor"/>
                    <path d="M8 1V3M8 13V15M15 8H13M3 8H1M13.657 2.343L12.243 3.757M3.757 12.243L2.343 13.657M13.657 13.657L12.243 12.243M3.757 3.757L2.343 2.343" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <svg class="navbar-theme-icon moon" width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5 8C13.5 11.5899 10.5899 14.5 7 14.5C5.5 14.5 4.1 14 3 13.1C3.3 12.9 3.6 12.6 3.8 12.3C4.1 12.4 4.4 12.5 4.7 12.5C7.26142 12.5 9.5 10.2614 9.5 7.7C9.5 5.13858 7.26142 3 4.7 3C4.4 3 4.1 3.1 3.8 3.2C3.6 2.9 3.3 2.6 3 2.4C4.1 1.5 5.5 1 7 1C10.5899 1 13.5 3.91015 13.5 7.5V8Z" fill="currentColor"/>
                  </svg>
                </span>
              </button>
            </div>
            <div class="nav-fullscreen-wrapper">
              <div class="nav-toggle-wrapper w-nav-button">
                <div class="nav-toggle-inner">
                  <div class="nav-toggle-icon-wrapper">
                    <div class="nav-toggle-icon-line _01"></div>
                    <div class="nav-toggle-icon-line _02"></div>
                  </div>
                  <div class="nav-toggle-text">Menu</div>
                </div>
              </div>
              <div style="display:none" class="navbar-fullscreen-component">
                <div class="navbar-open">
                  <div class="page-padding">
                    <div class="nav-main-inner">
                      <div class="nav-main-column is-ghost"></div>
                      <div class="nav-toggle-wrapper w-nav-button">
                        <div class="nav-toggle-inner">
                          <div class="nav-toggle-icon-wrapper">
                            <div class="nav-toggle-icon-line _01"></div>
                            <div class="nav-toggle-icon-line _02"></div>
                          </div>
                          <div class="nav-toggle-text">Menu</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <nav role="navigation" style="display:none" class="navbar-menu w-nav-menu">
                  <div class="navbar-content-wrapper">
                    <div class="navbar-left">
                      <div class="page-padding is-navbar">
                        <div class="navbar-left-inner">
                          <div class="nav-links-column is-main">
                            <div class="nav-animate-1">
                              <a href="../index.html" class="nav-link-item is-main-link w-inline-block">
                                <div class="nav-link-text">HOME</div>
                              </a>
                            </div>
                            <div class="nav-animate-2">
                              <a href="../store.html" class="nav-link-item is-main-link w-inline-block">
                                <div class="nav-link-text">SHOP</div>
                              </a>
                            </div>
                            <div class="nav-animate-3">
                              <a href="../media.html" class="nav-link-item is-main-link w-inline-block">
                                <div class="nav-link-text">MEDIA</div>
                              </a>
                            </div>
                            <div class="nav-animate-4">
                              <div class="social-links-component">
                                <div class="social-media-links-list is-large">
                                  <!-- Social links can be added here if needed -->
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="nav-links-column">
                            <div class="nav-animate-1">
                              <a href="../carousel-template.html" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">Bracelets</div>
                              </a>
                            </div>
                            <div class="nav-animate-2">
                              <a href="../carousel-template.html" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">Chains</div>
                              </a>
                            </div>
                            <div class="nav-animate-3">
                              <a href="../carousel-template.html" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">Hoodies</div>
                              </a>
                            </div>
                            <div class="nav-animate-4">
                              <a href="../carousel-template.html" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">T-shirts</div>
                              </a>
                            </div>
                            <div class="nav-animate-5">
                              <a href="#" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">About Us</div>
                              </a>
                            </div>
                            <div class="nav-animate-5">
                              <a href="#" class="nav-link-item w-inline-block">
                                <div class="nav-link-text">Contact Us</div>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="navbar-right">
                      <div class="page-padding is-navbar">
                        <div class="navbar-right-content-wrapper">
                          <!-- Slider Version (v2) - Visible for desktop and mobile -->
                          <div class="navbar-right-content v2">
                            <!-- Promotional Slider (Webflow w-slider) -->
                            <div data-delay="4000" data-animation="slide" class="slider w-slider" data-autoplay="false" data-easing="ease" data-hide-arrows="false" data-disable-swipe="false" data-autoplay-limit="0" data-nav-spacing="3" data-duration="500" data-infinite="true">
                              <div class="w-slider-mask">
                                <!-- Slide 1 -->
                                <div class="w-slide">
                                  <div class="slider-content">
                                    <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="New Collection Drop" class="slider-img">
                                    <div class="slider-content-wrapper">
                                      <h3>New Collection Drop</h3>
                                      <p>Discover our latest limited edition pieces. Exclusive designs you won't find anywhere else.</p>
                                    </div>
                                  </div>
                                </div>
                                <!-- Slide 2 -->
                                <div class="w-slide">
                                  <div class="slider-content">
                                    <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="Summer Sale" class="slider-img">
                                    <div class="slider-content-wrapper">
                                      <h3>Summer Sale</h3>
                                      <p>Up to 50% off selected items. Limited time offer while supplies last.</p>
                                    </div>
                                  </div>
                                </div>
                                <!-- Slide 3 -->
                                <div class="w-slide">
                                  <div class="slider-content">
                                    <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="Exclusive Media" class="slider-img">
                                    <div class="slider-content-wrapper">
                                      <h3>Exclusive Media</h3>
                                      <p>Behind the scenes content, exclusive interviews, and more from The Kiosk.</p>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="w-slider-nav w-slider-nav-invert w-shadow w-round"></div>
                            </div>
                          </div>
                          <!-- Static Cards Version (v1) - Hidden -->
                          <div class="navbar-right-content v1">
                            <div class="scale-on-hover">
                              <a href="../carousel-template.html" class="navbar-right-item w-inline-block">
                                <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="New Collection Drop" class="navbar-right-image">
                                <div class="navbar-right-text-wrapper">
                                  <div class="navbar-right-text">New Collection Drop</div>
                                </div>
                              </a>
                            </div>
                            <div class="scale-on-hover">
                              <a href="../carousel-template.html" class="navbar-right-item w-inline-block">
                                <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="Summer Sale" class="navbar-right-image">
                                <div class="navbar-right-text-wrapper">
                                  <div class="navbar-right-text">Summer Sale</div>
                                </div>
                              </a>
                            </div>
                            <div class="scale-on-hover">
                              <a href="../carousel-template.html" class="navbar-right-item w-inline-block">
                                <img src="../images/kiosk-placeholder-product-img.webp" loading="lazy" alt="Exclusive Media" class="navbar-right-image">
                                <div class="navbar-right-text-wrapper">
                                  <div class="navbar-right-text">Exclusive Media</div>
                                </div>
                              </a>
                            </div>
                          </div>
                          <!-- See Styleguide (bottom right) -->
                          <div class="navbar-right-styleguide">
                            <a href="../kiosk-styleguide.html" class="w-inline-block">
                              <div class="scale-on-hover">
                                <div class="navbar-right-text navbar-right-text-low-visibility">See Styleguide</div>
                              </div>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Collection Title (animated) -->
  <div id="collection-title" class="collection-title">
    <h1 class="collection-title-text">Collection</h1>
  </div>
  
  <!-- 3D Carousel Component -->
  <div carousel="component" class="carousel_component">
    
    <!-- 3D Image Carousel -->
    <div carousel="wrap" class="carousel_wrap">
      <div class="carousel_list">
        <!-- Carousel Items - Images will be loaded dynamically -->
        <div class="carousel_item" data-product-index="0">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 001" class="carousel_img" loading="eager">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 002" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 003" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 004" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 005" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 006" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 007" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 008" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 009" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 010" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 011" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 012" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 013" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 014" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 015" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="../images/kiosk-placeholder-product-img.webp" alt="Product 016" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
      </div>
    </div>

    <!-- Swiper Slider for Titles -->
    <div fade-up="" class="swiper">
      <div class="swiper-wrapper">
        <!-- Slides - Add your titles here -->
        <!-- Add data-product-handle attribute with your Shopify product handle -->
        <div class="swiper-slide" data-product-handle="product-handle-1">
          <h2>Product 001</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-2">
          <h2>Product 002</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-3">
          <h2>Product 003</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-4">
          <h2>Product 004</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-5">
          <h2>Product 005</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-6">
          <h2>Product 006</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-7">
          <h2>Product 007</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-8">
          <h2>Product 008</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-9">
          <h2>Product 009</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-10">
          <h2>Product 010</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-11">
          <h2>Product 011</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-12">
          <h2>Product 012</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-13">
          <h2>Product 013</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-14">
          <h2>Product 014</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-15">
          <h2>Product 015</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-16">
          <h2>Product 016</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
      </div>
    </div>

    <!-- Navigation Arrows -->
    <div fade-up="" class="carousel_arrow_wrap">
      <a carousel="prev" href="#" class="carousel_arrow_link"></a>
      <a carousel="next" href="#" class="carousel_arrow_link is-right"></a>
    </div>
  </div>

  <!-- Product Drawer -->
  <div class="products_collection-drawer" id="product-drawer">
    <div class="products_drawer-close" id="drawer-close-overlay"></div>
    <div class="products_drawer-wrapper">
      <button class="products_drawer-close-icon" id="drawer-close-btn" aria-label="Close drawer"></button>
      
      <div class="products_drawer-title">
        <h3 id="drawer-product-title"></h3>
        <h3 id="drawer-product-price"></h3>
      </div>
      
      <div class="products_drawer-content">
        <!-- Images Section -->
        <div class="products_drawer-images">
          <img src="" loading="lazy" alt="Product image" class="products_drawer-main-image" id="drawer-main-image">
          <div class="products_drawer-more-collection" id="drawer-gallery">
            <!-- Gallery images will be populated dynamically -->
          </div>
        </div>
        
        <!-- Product Details Section -->
        <div class="products_drawer-text">
          <div class="products_text-top">
            <div class="products_quantity-wrapper">
              <div class="margin-bottom margin-xsmall">
                <h4 class="uppercase">qty</h4>
              </div>
              <input type="number" pattern="^[0-9]+$" inputmode="numeric" id="drawer-quantity" name="quantity" min="1" class="products_quantity" value="1">
            </div>
            <button id="drawer-add-to-cart" class="button-secondary">Add to Cart</button>
            <div style="display:none" class="products_out-of-stock" id="drawer-out-of-stock">
              <div>This product is out of stock.</div>
            </div>
            <div style="display:none" class="products_error" id="drawer-error">
              <div>Error loading product details.</div>
            </div>
          </div>
          
          <div class="products_text-bottom">
            <div class="margin-bottom margin-medium">
              <h4 class="uppercase">product info</h4>
            </div>
            
            <!-- Description Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon"></span>
                  <p>Description</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <div class="paragraph" id="drawer-description"></div>
              </div>
            </div>
            
            <!-- Care Instructions Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon"></span>
                  <p>Care Instructions</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <div class="paragraph" id="drawer-care-instructions"></div>
              </div>
            </div>
            
            <!-- Delivery Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon"></span>
                  <p>Delivery</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <p id="drawer-delivery"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Loading Spinner -->
    <div class="drawer-loading" id="drawer-loading" style="display:none;">
      <div class="loading-spinner"></div>
      <p>Loading product details...</p>
    </div>
  </div>

  <!-- Scripts -->
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/navigation.js" type="text/javascript"></script>
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  
  <!-- Webflow JS (for navigation slider) -->
  <script src="../js/webflow.js" type="text/javascript"></script>
  
  <!-- Swiper JS (for 3D carousel - carousel uses its own JS) -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  
  <!-- Lenis Smooth Scroll JS -->
  <script src="https://unpkg.com/lenis@1.3.15/dist/lenis.min.js"></script>
  <script src="../js/lenis.js" type="text/javascript"></script>
  
  <!-- Airtable Integration -->
  <script src="../js/config.js" type="text/javascript"></script>
  <script src="../js/airtable.js" type="text/javascript"></script>

  <!-- 3D Carousel Script -->
  <script>
    // Prevent scrolling on page, but allow swipe gestures on carousel
    document.addEventListener('DOMContentLoaded', function() {
      // Extract collection from URL path
      // Extract collection from URL path (e.g., /collections/t-shirts -> t-shirts)
      const pathParts = window.location.pathname.split('/');
      const collectionHandle = pathParts[pathParts.length - 1].replace('.html', '') || 'chains';
      
      // Load collection data and products if collection parameter is present
      let collectionData = null;
      let collectionProducts = [];
      
      // Function to format collection title for display
      function formatCollectionTitle(handle) {
        if (!handle) return 'Collection';
        // Convert handle to title: "gold-bracelets" -> "Gold Bracelets", "t-shirts" -> "T-Shirts"
        return handle.split('-').map(word => 
          word.charAt(0).toUpperCase() + word.slice(1)
        ).join(' ');
      }
      
      // Update title immediately if collection handle is present (before API call)
      if (collectionHandle) {
        const initialTitle = formatCollectionTitle(collectionHandle);
        updateCollectionTitle(initialTitle);
      }
      
      // Function to update collection title and page title
      function updateCollectionTitle(title) {
        const collectionTitleEl = document.getElementById('collection-title');
        const collectionTitleText = collectionTitleEl?.querySelector('.collection-title-text');
        const pageTitleEl = document.getElementById('page-title');
        
        if (collectionTitleText) {
          collectionTitleText.textContent = title;
        }
        
        if (pageTitleEl) {
          pageTitleEl.textContent = `${title} - Only at The Kiosk`;
        }
      }
      
      // Function to load products from Airtable collection
      async function loadCollectionProducts(handle) {
        if (!window.airtable) {
          console.warn('Airtable client not loaded, using placeholder products');
          updateCollectionTitle(formatCollectionTitle(handle));
          return Promise.resolve();
        }
        
        console.log(` Loading products from Airtable collection: "${handle}"`);
        
        try {
          // Fetch collection data from Airtable
          const collection = await window.airtable.getCollection(handle);
          
          if (collection && collection.products && collection.products.edges && collection.products.edges.length > 0) {
            collectionData = collection;
            collectionProducts = collection.products.edges.map(edge => edge.node);
            
            console.log(` Loaded ${collectionProducts.length} products from Airtable`);
            console.log(` Collection: "${collection.title || handle}"`);
            
            // Update collection title with actual Airtable title
            const collectionTitle = collection.title || formatCollectionTitle(handle);
            updateCollectionTitle(collectionTitle);
            
            // Update carousel with products from Airtable
            updateCarouselWithProducts(collectionProducts);
            
            // Trigger products loaded event
            $(document).trigger('productsLoaded');
            
            return Promise.resolve();
          } else {
            // Collection has no products
            console.warn(` Collection "${handle}" has no products in Airtable`);
            console.warn(` Check Airtable  Products table  Collection field to verify products are assigned`);
            // Update title but keep placeholder products
            updateCollectionTitle(formatCollectionTitle(handle));
            return Promise.resolve();
          }
        } catch (error) {
          console.error(' Error loading collection products from Airtable:', error);
          console.error(' Verify:');
          console.error('   1. AIRTABLE_ACCESS_TOKEN is set in Cloudflare Pages');
          console.error('   2. AIRTABLE_BASE_ID is set in Cloudflare Pages');
          console.error('   3. Products table exists in Airtable');
          console.error('   4. Collection name matches Airtable (case-sensitive)');
          // Fallback to formatted handle
          updateCollectionTitle(formatCollectionTitle(handle));
          return Promise.resolve();
        }
      }
      
      // Function to update carousel with Shopify products
      function updateCarouselWithProducts(products) {
        if (!products || products.length === 0) {
          console.warn('No products to display, using placeholder products');
          return;
        }
        
        const carouselList = $('.carousel_list');
        const swiperWrapper = $('.swiper-wrapper');
        const wrapEl = $("[carousel='wrap']");
        
        // Clear existing items and slides
        carouselList.empty();
        swiperWrapper.empty();
        
        // Create carousel items and swiper slides for each product
        products.forEach((product, index) => {
          // Create carousel item (3D image)
          const carouselItem = $(`
            <div class="carousel_item" data-product-index="${index}">
              <img src="${product.images && product.images.edges && product.images.edges.length > 0 ? product.images.edges[0].node.url : '/images/kiosk-placeholder-product-img.webp'}" 
                   alt="${product.title}" 
                   class="carousel_img" 
                   loading="${index < 3 ? 'eager' : 'lazy'}">
              <div class="carousel_ratio"></div>
            </div>
          `);
          carouselList.append(carouselItem);
          
          // Create swiper slide (title and button)
          const swiperSlide = $(`
            <div class="swiper-slide" data-product-handle="${product.handle}">
              <h2>${product.title}</h2>
              <a href="#" class="button view-details-btn">view details</a>
            </div>
          `);
          swiperWrapper.append(swiperSlide);
        });
        
        // Recalculate carousel layout with new number of items
        const itemEl = wrapEl.find(".carousel_item");
        const rotateAmount = 360 / itemEl.length;
        const zTranslate = 2 * Math.tan((rotateAmount / 2) * (Math.PI / 180));
        const negTranslate = `calc(var(--3d-carousel-item-width) / -${zTranslate} - var(--3d-carousel-gap))`;
        const posTranslate = `calc(var(--3d-carousel-item-width) / ${zTranslate} + var(--3d-carousel-gap))`;
        
        wrapEl.css("--3d-carousel-z", negTranslate);
        wrapEl.css("perspective", posTranslate);
        
        // Position each item in 3D space
        itemEl.each(function (index) {
          $(this).css({
            left: '50%',
            top: '50%',
            transform: `translate(-50%, -50%) rotateY(${rotateAmount * index}deg) translateZ(${posTranslate})`
          });
          
          // Ensure images load and are visible
          const img = $(this).find('.carousel_img');
          if (img.length) {
            img.on('load', function() {
              $(this).css({ opacity: 1, visibility: 'visible' });
            }).on('error', function() {
              console.error('Failed to load image:', $(this).attr('src'));
              $(this).attr('src', '/images/kiosk-placeholder-product-img.webp');
            });
            
            if (img[0].complete && img[0].naturalHeight !== 0) {
              img.css({ opacity: 1, visibility: 'visible' });
            }
          }
        });
        
        // Store products count for carousel initialization
        window.dynamicProductsCount = products.length;
      }
      
      // Animate collection title from center to top using GSAP
      const collectionTitle = document.getElementById('collection-title');
      if (collectionTitle && typeof gsap !== 'undefined') {
        // Set initial centered position explicitly using xPercent for proper centering
        gsap.set(collectionTitle, {
          left: '50%',
          top: '50%',
          xPercent: -50, // Center horizontally (-50% of element width)
          yPercent: -50  // Center vertically (-50% of element height)
        });
        
        // Wait 1 second, then animate to top - only animate vertical position, keep x centered
        gsap.to(collectionTitle, {
          top: '6rem', // Position below navbar with spacing (navbar is 4rem high, add 2rem spacing)
          yPercent: 0, // Remove vertical centering, align with top
          // xPercent stays at -50 (maintains horizontal centering)
          duration: 1.2,
          ease: "power2.inOut",
          delay: 1 // Wait 1 second after page load
        });
      }
      
      // Function to wait for Airtable client to be ready
      function waitForAirtable(maxAttempts = 50, attempt = 0) {
        return new Promise((resolve, reject) => {
          if (window.airtable) {
            resolve();
          } else if (attempt >= maxAttempts) {
            console.warn('Airtable client not loaded after maximum attempts');
            reject(new Error('Airtable client not available'));
          } else {
            setTimeout(() => waitForAirtable(maxAttempts, attempt + 1).then(resolve).catch(reject), 100);
          }
        });
      }
      
      // Load collection if handle is provided (after DOM is ready)
      if (collectionHandle) {
        // Wait for Airtable client to be ready, then load collection
        waitForAirtable()
          .then(() => loadCollectionProducts(collectionHandle))
          .catch(() => {
            // Airtable client not available, use placeholder
            console.warn('Using placeholder products - Airtable client not available');
            updateCollectionTitle(formatCollectionTitle(collectionHandle));
          });
      } else {
        // Default collection title
        updateCollectionTitle('Collection');
      }
      
      // Only prevent scrolling inside the drawer when it's open
      // Allow free swiping/scrolling everywhere else
      let drawerOpen = false;
      
      // Monitor drawer state to adjust scroll behavior
      $(document).on('drawerOpen', function() {
        drawerOpen = true;
        // Lock scroll only when drawer is open
        document.body.style.overflow = 'hidden';
      });
      
      $(document).on('drawerClose', function() {
        drawerOpen = false;
        // Re-enable scroll when drawer closes
        document.body.style.overflow = '';
      });
    });
    
    $(document).ready(function() {
      $("[carousel='component']").each(function () {
        let componentEl = $(this);
        let wrapEl = componentEl.find("[carousel='wrap']");
        let swiperEl = componentEl.find(".swiper");
        let nextEl = componentEl.find("[carousel='next']");
        let prevEl = componentEl.find("[carousel='prev']");
        
        // Check if wrapEl exists before proceeding
        if (wrapEl.length === 0) {
          console.warn('Carousel wrap element not found, skipping initialization');
          return;
        }
        
        let itemEl = wrapEl.find(".carousel_item");
        
        // Use dynamic products count if available, otherwise use existing items
        const productCount = window.dynamicProductsCount || itemEl.length;
        
        // Skip if no products
        if (productCount === 0) {
          console.warn('No products found, skipping carousel initialization');
          return;
        }
        
        // Calculate rotation angle per item (360 / number of items)
        let rotateAmount = 360 / productCount;
        
        // Calculate Z-distance for proper 3D perspective
        let zTranslate = 2 * Math.tan((rotateAmount / 2) * (Math.PI / 180));
        
        // Calculate translate values
        let negTranslate = `calc(var(--3d-carousel-item-width) / -${zTranslate} - var(--3d-carousel-gap))`;
        let posTranslate = `calc(var(--3d-carousel-item-width) / ${zTranslate} + var(--3d-carousel-gap))`;

        // Set perspective and Z-position (only if wrapEl exists)
        if (wrapEl.length > 0) {
          wrapEl.css("--3d-carousel-z", negTranslate);
          wrapEl.css("perspective", posTranslate);
        }
        
        // Position each item in 3D space (only if items exist)
        // Items are centered at origin, then rotated and translated outward
        if (itemEl.length > 0) {
          itemEl.each(function (index) {
            $(this).css({
              left: '50%',
              top: '50%',
              transform: `translate(-50%, -50%) rotateY(${rotateAmount * index}deg) translateZ(${posTranslate})`
            });
            
            // Ensure images load and are visible
            const img = $(this).find('.carousel_img');
            if (img.length) {
              img.on('load', function() {
                $(this).css({ opacity: 1, visibility: 'visible' });
              }).on('error', function() {
                console.error('Failed to load image:', $(this).attr('src'));
                // Fallback to placeholder
                $(this).attr('src', '/images/kiosk-placeholder-product-img.webp');
              });
              
              // Force image to be visible if already loaded
              if (img[0].complete && img[0].naturalHeight !== 0) {
                img.css({ opacity: 1, visibility: 'visible' });
              }
            }
          });
        }

        // Prevent touch events on carousel wrapper from moving the page on mobile
        // Removed touch event handlers - allow free swiping everywhere
        // Swiper will handle its own touch events naturally

        // Check if products are being loaded dynamically
        const isDynamicLoad = window.dynamicProductsCount !== undefined;
        
        // INTRO ANIMATION
        let introTl = gsap.timeline({
          onComplete: () => {
            // Wait for products if they're being loaded
            if (isDynamicLoad) {
              // Listen for products loaded event
              $(document).one('productsLoaded', () => {
                setTimeout(() => swiperCode(), 100);
              });
              // Fallback: initialize after a delay if products don't load
              setTimeout(() => {
                if (!window.swiperInitialized) {
                  swiperCode();
                }
              }, 2000);
            } else {
              swiperCode();
            }
          }
        });
        
        // Fade in (only if wrapEl exists)
        if (wrapEl.length > 0) {
          introTl.to(wrapEl, { opacity: 1, duration: 0.3 });
          
          // Rotate from off-screen to position
          introTl.fromTo(
            wrapEl, 
            { 
              "--3d-carousel-rotate": 100,
              "--3d-carousel-rotate-x": -90
            }, 
            { 
              "--3d-carousel-rotate": 0,
              "--3d-carousel-rotate-x": -4,
              duration: 4, 
              ease: "power2.inOut" 
            }, 
            "<"
          );
        }
        
        // Fade in titles and arrows
        introTl.to("[fade-up]", { opacity: 1 }, ">-0.3");

        function swiperCode() {
          // Create continuous rotation timeline
          let tl = gsap.timeline({ paused: true });
          tl.fromTo(
            wrapEl, 
            { "--3d-carousel-rotate": 0 }, 
            { 
              "--3d-carousel-rotate": -(360 - rotateAmount),
              duration: 30, 
              ease: "none" 
            }
          );

          // Progress tracker for syncing
          let progress = { value: 0 };

          // Get current slides count (may have been updated dynamically)
          const currentSlides = swiperEl.find('.swiper-slide');
          if (currentSlides.length === 0) {
            console.warn('No swiper slides found, skipping Swiper initialization');
            return;
          }
          
          // Mark Swiper as initialized
          window.swiperInitialized = true;
          
          // Initialize Swiper with mobile-friendly touch gestures
          const swiper = new Swiper(swiperEl[0], {
            effect: "creative",
            creativeEffect: {
              prev: {
                translate: [0, "-100%", 0],
                scale: 0.5,
                opacity: 0
              },
              next: {
                translate: [0, "100%", 0],
                scale: 0.5,
                opacity: 0
              }
            },
            // Touch and swipe settings for mobile
            grabCursor: true,
            touchRatio: 1,
            touchAngle: 45,
            simulateTouch: true,
            allowTouchMove: true,
            touchStartPreventDefault: false,
            touchMoveStopPropagation: false,
            // Swipe settings
            slidesPerView: 1,
            spaceBetween: 0,
            // Keyboard support
            keyboard: {
              enabled: true,
              onlyInViewport: true
            },
            // Mousewheel support (desktop)
            mousewheel: {
              enabled: true,
              eventsTarget: "[carousel='component']",
              sensitivity: 1,
              forceToAxis: true
            },
            speed: 500,
            // Navigation arrows
            navigation: {
              nextEl: nextEl[0],
              prevEl: prevEl[0],
              disabledClass: "swiper-button-disabled"
            },
            // Touch events
            touchEventsTarget: 'container',
            // Prevent clicks during swipe
            preventClicks: true,
            preventClicksPropagation: true,
            // Resistance when reaching edges
            resistance: true,
            resistanceRatio: 0.85
          });
          
          // Sync Swiper progress with 3D rotation
          swiper.on("progress", function (e) {
            gsap.to(progress, {
              value: e.progress,
              onUpdate: () => {
                tl.progress(progress.value);
              }
            });
          });

          // Update arrow states
          swiper.on("reachBeginning", function () {
            prevEl.addClass("swiper-button-disabled");
          });
          swiper.on("reachEnd", function () {
            nextEl.addClass("swiper-button-disabled");
          });
          swiper.on("fromEdge", function () {
            prevEl.removeClass("swiper-button-disabled");
            nextEl.removeClass("swiper-button-disabled");
          });
          
          // Remove all custom touch/wheel handlers - let Swiper handle everything naturally
          // Users can now swipe freely anywhere on the screen
          // Only the "view details" button will open the drawer
        }
      });
      
      // Function to load carousel images from Airtable (legacy - now handled by updateCarouselWithProducts)
      // This function is kept for backward compatibility but is no longer needed
      async function loadCarouselImagesFromShopify() {
        // This is now handled by updateCarouselWithProducts() which loads products and images together
        console.log('loadCarouselImagesFromShopify is deprecated - use updateCarouselWithProducts instead');
      }
      
      // Function to load carousel images from Supabase
      async function loadCarouselImagesFromSupabase() {
        // Uncomment and configure if using Supabase
        /*
        const slides = $('.swiper-slide');
        const handles = slides.map(function() {
          return $(this).data('product-handle');
        }).get();
        
        try {
          const response = await fetch(
            `${SUPABASE_URL}/rest/v1/products?handle=in.(${handles.join(',')})&select=handle,primary_image`,
            {
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
              }
            }
          );
          const products = await response.json();
          
          products.forEach(product => {
            if (product.primary_image) {
              const slideIndex = handles.indexOf(product.handle);
              if (slideIndex !== -1) {
                const carouselItem = $('.carousel_item').eq(slideIndex);
                carouselItem.find('.carousel_img').attr('src', product.primary_image);
              }
            }
          });
        } catch (error) {
          console.error('Failed to load images from Supabase:', error);
        }
        */
      }
    });

    // Product Drawer Functionality
    $(document).ready(function() {
      const drawer = $('#product-drawer');
      const drawerOverlay = $('#drawer-close-overlay');
      const drawerCloseBtn = $('#drawer-close-btn');
      const viewDetailsBtns = $('.view-details-btn');
      
      // Airtable API Configuration
      // Fetch product from Airtable using the Airtable client
      // The Airtable client uses the /api/airtable proxy function to keep tokens server-side
      async function fetchProduct(handle) {
        try {
          if (!window.airtable) {
            throw new Error('Airtable client not loaded. Please ensure js/airtable.js is loaded.');
          }
          
          console.log(` Fetching product from Airtable: "${handle}"`);
          
          // Fetch from Airtable
          const product = await window.airtable.getProductByHandle(handle);
          
          if (!product) {
            throw new Error(`Product with handle "${handle}" not found in Airtable`);
          }
          
          console.log(` Product loaded from Airtable: "${product.title}"`);
          console.log(` Price: ${product.priceRange?.minVariantPrice?.amount || 'N/A'} ${product.priceRange?.minVariantPrice?.currencyCode || ''}`);
          console.log(` Images: ${product.images?.edges?.length || 0}`);
          
          return product;
        } catch (error) {
          console.error(' Error fetching product from Airtable:', error);
          console.error(' Verify:');
          console.error('   1. Product handle is correct');
          console.error('   2. Product exists in Airtable Products table');
          console.error('   3. AIRTABLE_ACCESS_TOKEN is configured');
          console.error('   4. AIRTABLE_BASE_ID is configured');
          throw error;
        }
      }

      // Populate drawer with product data
      function populateDrawer(product) {
        // Product title and price
        $('#drawer-product-title').text(product.title);
        const price = product.priceRange.minVariantPrice;
        const formattedPrice = window.airtable ? window.airtable.formatPrice(price.amount, price.currencyCode) : `${price.amount} ${price.currencyCode}`;
        $('#drawer-product-price').text(formattedPrice);

        // Main image
        if (product.images.edges.length > 0) {
          const mainImage = product.images.edges[0].node;
          $('#drawer-main-image').attr('src', mainImage.url).attr('alt', mainImage.altText || product.title);
          
          // Gallery images
          const gallery = $('#drawer-gallery');
          gallery.empty();
          
          if (product.images.edges.length > 1) {
            product.images.edges.slice(1).forEach(({ node: image }) => {
              const galleryItem = $('<div class="products_drawer-more-item"></div>');
              const galleryImg = $('<img class="products_drawer-more-image" loading="lazy">');
              galleryImg.attr('src', image.url).attr('alt', image.altText || product.title);
              galleryItem.append(galleryImg);
              galleryItem.on('click', () => {
                $('#drawer-main-image').attr('src', image.url).attr('alt', image.altText || product.title);
              });
              gallery.append(galleryItem);
            });
          }
        }

        // Description
        if (product.descriptionHtml) {
          $('#drawer-description').html(product.descriptionHtml);
        } else if (product.description) {
          $('#drawer-description').text(product.description);
        } else {
          $('#drawer-description').text('No description available.');
        }

        // Care instructions (from Airtable)
        const careInstructions = product.careInstructions || null;
        if (careInstructions) {
          $('#drawer-care-instructions').html(careInstructions);
        } else {
          $('#drawer-care-instructions').html('<p>Care instructions not available.</p>');
        }

        // Delivery information (standard message, can be customized per product in Airtable if needed)
        $('#drawer-delivery').html(`
          <p><strong>Shipping Information:</strong></p>
          <p>Standard shipping: 5-7 business days<br>
          Express shipping: 2-3 business days<br>
          Free shipping on orders over $100<br>
          International shipping available</p>
        `);

        // Stock status
        const isAvailable = product.variants.edges[0]?.node.availableForSale || false;
        if (!isAvailable) {
          $('#drawer-out-of-stock').show();
          $('#drawer-add-to-cart').prop('disabled', true);
        } else {
          $('#drawer-out-of-stock').hide();
          $('#drawer-add-to-cart').prop('disabled', false);
        }

        // Hide error if previously shown
        $('#drawer-error').hide();
      }

      // Fetch image from Supabase (optional - if you store image URLs in Supabase)
      async function fetchImageFromSupabase(productHandle) {
        try {
          // Uncomment and configure if using Supabase
          /*
          const response = await fetch(
            `${SUPABASE_URL}/rest/v1/products?handle=eq.${productHandle}&select=primary_image`,
            {
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
              }
            }
          );
          const data = await response.json();
          if (data && data.length > 0 && data[0].primary_image) {
            return data[0].primary_image;
          }
          */
          return null;
        } catch (error) {
          console.error('Error fetching image from Supabase:', error);
          return null;
        }
      }

      // Placeholder product data for template products
      // Each product handle corresponds to a carousel slide
      function getPlaceholderProduct(productHandle) {
        // IMAGE SOURCE OPTIONS (choose one):
        
        // Option 1: Placeholder service (fast, no hosting, good for testing)
        const placeholderImage = '/images/kiosk-placeholder-product-img.webp';
        
        // Option 2: Unsplash (free, high-quality, good for demos)
        // const placeholderImage = 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=800&h=800&fit=crop&auto=format';
        
        // Option 3: Your hosted placeholder (now using WebP format)
        // const placeholderImage = '/images/kiosk-placeholder-product-img.webp'; // Already active above
        
        // Option 4: Cloudinary or other CDN (best for production)
        // const placeholderImage = 'https://res.cloudinary.com/your-cloud/image/upload/w_800,h_800,c_fill/product-placeholder.jpg';
        
        // Option 5: Fetch from Supabase (async - see fetchImageFromSupabase above)
        // This would require making the function async and awaiting the result
        
        // Generate product titles (Product 001, Product 002, etc.)
        const productTitles = [];
        for (let i = 1; i <= 16; i++) {
          const num = i.toString().padStart(3, '0');
          productTitles.push(`Product ${num}`);
        }
        
        const productPrices = ['299.00', '349.00', '379.00', '399.00', '429.00', '449.00', '479.00', '499.00', '529.00', '549.00', '579.00', '599.00', '629.00', '649.00', '679.00', '699.00'];
        
        // Extract product index from handle (e.g., 'product-handle-1' -> 0)
        const handleMatch = productHandle.match(/product-handle-(\d+)/);
        const index = handleMatch ? parseInt(handleMatch[1]) - 1 : 0;
        const title = productTitles[index] || 'Product 001';
        const price = productPrices[index] || '299.00';

        // Use placeholder image for main image and gallery
        // You can add multiple gallery images later if needed
        const galleryImages = [
          placeholderImage,
          placeholderImage,
          placeholderImage
        ];

        return {
          title: title,
          price: { amount: price, currencyCode: 'SEK' },
          mainImage: placeholderImage,
          gallery: galleryImages,
          description: `<p>${title} is a premium product designed for the modern lifestyle. Crafted with cutting-edge technology and attention to detail, this item represents the perfect blend of style and functionality. Each piece is carefully selected and designed to meet the highest standards of quality.</p><p>Experience the difference with ${title} - where innovation meets timeless design.</p>`,
          careInstructions: '<p><strong>Care Instructions:</strong></p><ul><li>Hand wash recommended in cold water</li><li>Do not bleach or use harsh detergents</li><li>Lay flat to dry</li><li>Iron on low heat if needed</li><li>Store in a cool, dry place</li><li>Keep away from direct sunlight when storing</li></ul>'
        };
      }

      // Populate drawer with placeholder data
      function populatePlaceholderDrawer(placeholderData) {
        // Product title and price
        $('#drawer-product-title').text(placeholderData.title);
        $('#drawer-product-price').text(`${placeholderData.price.amount} ${placeholderData.price.currencyCode}`);

        // Main image
        $('#drawer-main-image').attr('src', placeholderData.mainImage).attr('alt', placeholderData.title);
        
        // Gallery images
        const gallery = $('#drawer-gallery');
        gallery.empty();
        
        if (placeholderData.gallery && placeholderData.gallery.length > 0) {
          placeholderData.gallery.forEach((imageUrl, index) => {
            const galleryItem = $('<div class="products_drawer-more-item"></div>');
            const galleryImg = $('<img class="products_drawer-more-image" loading="lazy">');
            galleryImg.attr('src', imageUrl).attr('alt', `${placeholderData.title} - Image ${index + 2}`);
            galleryItem.append(galleryImg);
            galleryItem.on('click', () => {
              $('#drawer-main-image').attr('src', imageUrl).attr('alt', `${placeholderData.title} - Image ${index + 2}`);
            });
            gallery.append(galleryItem);
          });
        }

        // Description
        if (placeholderData.description) {
          $('#drawer-description').html(placeholderData.description);
        }

        // Care instructions
        if (placeholderData.careInstructions) {
          $('#drawer-care-instructions').html(placeholderData.careInstructions);
        }

        // Delivery (default for all)
        $('#drawer-delivery').html(`
          <strong>Delivery Information:</strong><br>
          Standard shipping: 5-7 business days<br>
          Express shipping: 2-3 business days<br>
          Free shipping on orders over $100<br>
          International shipping available<br>
          Track your order through our shipping partner
        `);

        // Hide error and out of stock
        $('#drawer-error').hide();
        $('#drawer-out-of-stock').hide();
        $('#drawer-add-to-cart').prop('disabled', false);
      }

      // Store current product data for add to cart
      let currentProductData = null;
      let currentProductHandle = null;

      // Open drawer
      function openDrawer(productHandle) {
        currentProductHandle = productHandle;
        currentProductData = null; // Reset
        
        drawer.addClass('open');
        $('body').css('overflow', 'hidden'); // Lock body scroll
        $(document).trigger('drawerOpen'); // Trigger event for scroll lock
        
        // Also trigger the native event
        if (typeof window.CustomEvent !== 'undefined') {
          document.dispatchEvent(new CustomEvent('drawerOpen'));
        }

        // Check if it's a placeholder handle
        if (productHandle && productHandle.startsWith('product-handle-')) {
          // Show placeholder data immediately
          const placeholderData = getPlaceholderProduct(productHandle);
          populatePlaceholderDrawer(placeholderData);
          return;
        }

        // Otherwise, fetch from Airtable
        $('#drawer-loading').show();
        fetchProduct(productHandle)
          .then(product => {
            currentProductData = product; // Store for add to cart
            populateDrawer(product);
            $('#drawer-loading').hide();
          })
          .catch(error => {
            console.error('Error loading product:', error);
            $('#drawer-loading').hide();
            $('#drawer-error').show().find('div').text('Failed to load product details. Please try again.');
          });
      }

      // Close drawer
      function closeDrawer() {
        drawer.removeClass('open');
        $('body').css('overflow', ''); // Unlock body scroll
        $(document).trigger('drawerClose'); // Trigger event for scroll unlock
        
        // Also trigger the native event
        if (typeof window.CustomEvent !== 'undefined') {
          document.dispatchEvent(new CustomEvent('drawerClose'));
        }
      }

      // Event handlers
      viewDetailsBtns.on('click', function(e) {
        e.preventDefault();
        const slide = $(this).closest('.swiper-slide');
        const productHandle = slide.data('product-handle');
        
        if (productHandle) {
          openDrawer(productHandle);
        } else {
          alert('Product handle not found. Please add data-product-handle attribute.');
        }
      });

      drawerCloseBtn.on('click', closeDrawer);
      drawerOverlay.on('click', closeDrawer);

      // Close drawer on ESC key
      $(document).on('keydown', function(e) {
        if (e.key === 'Escape' && drawer.hasClass('open')) {
          closeDrawer();
        }
      });

      // Accordion functionality for description sections
      $('.products_description-question').on('click', function() {
        const item = $(this).closest('.products_description-item');
        const isActive = item.hasClass('active');
        
        // Close all items
        $('.products_description-item').removeClass('active');
        
        // Open clicked item if it wasn't active
        if (!isActive) {
          item.addClass('active');
        }
      });

      // Add to cart button - integrate with Shopify cart
      $('#drawer-add-to-cart').on('click', async function() {
        const button = $(this);
        const originalText = button.text();
        
        // Disable button during request
        button.prop('disabled', true).text('Adding...');
        
        try {
          // Use stored product data if available, otherwise fetch
          let product = currentProductData;
          
          if (!product && currentProductHandle) {
            product = await fetchProduct(currentProductHandle);
            currentProductData = product;
          }
          
          if (!product) {
            throw new Error('Product data not available');
          }
          
          if (!product.variants || !product.variants.edges || product.variants.edges.length === 0) {
            throw new Error('No variants available for this product');
          }
          
          // Get first available variant
          const firstVariant = product.variants.edges[0].node;
          if (!firstVariant.availableForSale) {
            throw new Error('This product is currently out of stock');
          }
          
          // Add to cart using cart manager
          if (!window.cart) {
            throw new Error('Cart manager not loaded. Please ensure js/cart.js is loaded.');
          }
          
          await window.cart.addItem(firstVariant.id, 1);
          
          // Show success message
          button.text('Added!').removeClass('btn-primary').addClass('btn-success');
          setTimeout(() => {
            button.text(originalText).removeClass('btn-success').addClass('btn-primary');
          }, 2000);
          
        } catch (error) {
          console.error('Error adding to cart:', error);
          alert('Failed to add item to cart: ' + error.message);
          button.text(originalText);
        } finally {
          button.prop('disabled', false);
        }
      });

      // ========================================
      // Development Mode Toggle for Container Borders
      // ========================================
      function toggleDebugBorders() {
        document.documentElement.classList.toggle('debug-borders');
        const isEnabled = document.documentElement.classList.contains('debug-borders');
        console.log('Debug borders:', isEnabled ? 'ON' : 'OFF');
        console.log('All container divs and wrappers now have colored 2px borders for debugging.');
        console.log('See docs/CONTAINER_BORDERS_CHEATSHEET.md for color reference.');
        return isEnabled;
      }

      // Auto-enable if URL parameter is present
      if (window.location.search.includes('debug=borders')) {
        toggleDebugBorders();
      }

      // Make function globally available
      window.toggleDebugBorders = toggleDebugBorders;
    });
  </script>
</body>
</html>

