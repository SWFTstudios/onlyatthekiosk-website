<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>3D Carousel Template - Only at The Kiosk</title>
  <meta content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover, user-scalable=yes" name="viewport">
  
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
  
  <!-- Custom Styles -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden; /* Prevent all scrolling */
      position: fixed; /* Lock viewport */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: #000;
      color: #fff;
      overscroll-behavior: none;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      /* Prevent touch scrolling */
      touch-action: none;
      -webkit-overflow-scrolling: none;
    }

    /* Fade-up elements start hidden */
    [fade-up], [carousel="wrap"] { 
      opacity: 0;
    }

    /* 3D Carousel Container */
    [carousel="component"] {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      height: 100dvh; /* Dynamic viewport height for mobile */
      max-width: 100vw;
      max-height: 100vh;
      max-height: 100dvh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 2rem 1rem 3rem 1rem; /* Extra bottom padding for scrolling */
      box-sizing: border-box;
      overflow-y: auto; /* Enable vertical scrolling */
      overflow-x: hidden; /* Prevent horizontal scrolling */
      /* Enable smooth scrolling */
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
      /* Allow touch scrolling on this container */
      touch-action: pan-y;
      /* Keep container centered */
      margin: 0;
      /* Custom scrollbar styling (optional) */
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
    }
    
    /* Custom scrollbar for webkit browsers */
    [carousel="component"]::-webkit-scrollbar {
      width: 8px;
    }
    
    [carousel="component"]::-webkit-scrollbar-track {
      background: transparent;
    }
    
    [carousel="component"]::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }
    
    [carousel="component"]::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.5);
    }

    /* Tablet - Adjust padding */
    @media screen and (max-width: 991px) {
      [carousel="component"] {
        padding: 0.75rem;
      }
    }

    /* Mobile - Minimal padding */
    @media screen and (max-width: 767px) {
      [carousel="component"] {
        padding: 1rem 0.5rem 2rem 0.5rem; /* Extra bottom padding for scrolling */
        height: 100svh; /* Small viewport height for mobile */
      }
    }

    @media screen and (max-width: 479px) {
      [carousel="component"] {
        padding: 0.75rem 0.25rem 1.5rem 0.25rem; /* Extra bottom padding for scrolling */
      }
    }

    /* 3D Carousel Wrapper */
    [carousel="wrap"] {
      will-change: contents;
      --3d-carousel-item-width: 40vw;
      --3d-carousel-gap: 7vw;
      --3d-carousel-rotate: 0deg;
      --3d-carousel-rotate-x: 0deg;
      --3d-carousel-z: 0px;
      position: relative;
      width: 100%;
      max-width: 100%;
      height: 50vh;
      max-height: 50vh;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      perspective-origin: center center;
      box-sizing: border-box;
      overflow: visible; /* Allow 3D items to extend beyond bounds */
      /* Prevent touch events from moving the carousel on mobile */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      /* Keep carousel centered */
      left: 0;
      right: 0;
      margin-left: auto;
      margin-right: auto;
    }

    /* Tablet Responsive */
    @media screen and (max-width: 991px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 70vw;
        --3d-carousel-gap: 6vw;
        height: 45vh;
        max-height: 45vh;
        margin-bottom: 1.25rem;
      }
    }

    /* Mobile - Smaller carousel items */
    @media screen and (max-width: 767px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 80vw;
        --3d-carousel-gap: 5vw;
        height: 40vh;
        max-height: 40vh;
        margin-bottom: 1rem;
      }
    }

    /* Small Mobile */
    @media screen and (max-width: 479px) {
      [carousel="wrap"] {
        --3d-carousel-item-width: 85vw;
        --3d-carousel-gap: 4vw;
        height: 35vh;
        max-height: 35vh;
        margin-bottom: 0.75rem;
      }
    }

    /* 3D Transform Container */
    [carousel="wrap"] > div {
      transform-style: preserve-3d;
      transform: translate3d(0px, 0px, var(--3d-carousel-z)) rotateX(var(--3d-carousel-rotate-x)) rotateY(var(--3d-carousel-rotate));
      width: 100%;
      height: 100%;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      transform-origin: center center;
      /* Prevent touch interactions from affecting position */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      /* Ensure container stays centered */
      margin-left: auto;
      margin-right: auto;
      /* Allow 3D items to extend beyond bounds */
      overflow: visible;
    }

    /* Individual Item Container */
    [carousel="wrap"] > div > div {
      width: var(--3d-carousel-item-width);
      position: absolute;
      transform-origin: center center;
    }

    /* Carousel List */
    .carousel_list {
      list-style: none;
      width: 100%;
      height: 100%;
      /* Prevent touch events from moving the carousel */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      pointer-events: none;
      position: relative;
      overflow: visible; /* Allow 3D items to extend beyond bounds */
    }

    /* Carousel Item */
    .carousel_item {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-origin: center center;
      top: 0;
      left: 0;
      /* Prevent touch events from moving the carousel */
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      pointer-events: none;
      overflow: visible; /* Ensure content isn't clipped */
    }

    /* Carousel Image */
    .carousel_img {
      display: block;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      /* Prevent image drag and touch interactions on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: none;
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-tap-highlight-color: transparent;
      /* Ensure image is visible */
      opacity: 1;
      visibility: visible;
      /* Ensure image renders */
      will-change: transform;
    }

    @media screen and (max-width: 479px) {
      .carousel_img {
        border-radius: 8px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
      }
    }

    /* Carousel Ratio (for aspect ratio) */
    .carousel_ratio {
      padding-bottom: 56.25%; /* 16:9 aspect ratio */
      position: relative;
      z-index: 0;
    }

    /* Swiper Container for Titles */
    .swiper {
      width: 100%;
      max-width: 600px;
      height: 180px;
      max-height: 180px;
      margin-bottom: 1rem;
      box-sizing: border-box;
      overflow-y: auto; /* Enable vertical scrolling */
      overflow-x: hidden; /* Prevent horizontal scrolling */
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
      /* Enable touch gestures for swiper */
      touch-action: pan-y;
      /* Custom scrollbar styling (optional) */
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
    }
    
    /* Custom scrollbar for swiper */
    .swiper::-webkit-scrollbar {
      width: 6px;
    }
    
    .swiper::-webkit-scrollbar-track {
      background: transparent;
    }
    
    .swiper::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
    }
    
    .swiper::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.5);
    }
    
    /* Swiper Wrapper - ensure content is visible */
    .swiper-wrapper {
      overflow: visible !important;
    }

    .swiper-slide {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 1.5rem 2rem;
      box-sizing: border-box;
      /* Prevent text selection during swipe */
      user-select: none;
      -webkit-user-select: none;
      /* Ensure content is fully visible */
      overflow: visible;
    }

    .swiper-slide h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      color: #fff;
      line-height: 1.2;
      white-space: nowrap; /* Prevent text wrapping */
      overflow: visible; /* Don't clip text */
      text-overflow: clip; /* Show full text */
    }

    /* Tablet */
    @media screen and (max-width: 991px) {
      .swiper {
        height: 150px;
        max-height: 150px;
        margin-bottom: 0.75rem;
      }
      
      .swiper-slide {
        padding: 1rem 1.5rem;
      }

      .swiper-slide h2 {
        font-size: 2rem;
      }
    }

    /* Mobile */
    @media screen and (max-width: 767px) {
      .swiper {
        height: 130px;
        max-height: 130px;
        margin-bottom: 0.75rem;
      }

      .swiper-slide {
        padding: 0.75rem 1rem;
      }

      .swiper-slide h2 {
        font-size: 1.75rem;
        margin-bottom: 0.5rem;
      }
    }

    /* Small Mobile */
    @media screen and (max-width: 479px) {
      .swiper {
        height: 120px;
        max-height: 120px;
        margin-bottom: 0.5rem;
      }

      .swiper-slide {
        padding: 0.5rem 0.75rem;
      }

      .swiper-slide h2 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }
    }

    .swiper-slide .button {
      padding: 10px 24px;
      background-color: #fff;
      color: #000;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      /* Touch-friendly button size */
      min-height: 40px;
      min-width: 40px;
      font-size: 0.875rem;
      white-space: nowrap;
    }

    .swiper-slide .button:hover {
      background-color: #f0f0f0;
      transform: scale(1.05);
    }

    .swiper-slide .button:active {
      transform: scale(0.98);
    }

    /* Mobile button adjustments */
    @media screen and (max-width: 767px) {
      .swiper-slide .button {
        padding: 8px 20px;
        font-size: 0.8rem;
        min-height: 36px;
      }
    }

    @media screen and (max-width: 479px) {
      .swiper-slide .button {
        padding: 6px 16px;
        font-size: 0.75rem;
        border-radius: 30px;
        min-height: 32px;
      }
    }

    /* Navigation Arrows */
    .carousel_arrow_wrap {
      display: flex;
      gap: 1rem;
      pointer-events: none;
    }

    .carousel_arrow_link {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      cursor: pointer;
      pointer-events: auto;
      transition: all 0.3s ease;
      position: relative;
      /* Touch-friendly size */
      min-width: 44px;
      min-height: 44px;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .carousel_arrow_link:hover {
      background-color: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    .carousel_arrow_link:active {
      transform: scale(0.95);
      background-color: rgba(255, 255, 255, 0.25);
    }

    /* Mobile arrow adjustments */
    @media screen and (max-width: 767px) {
      .carousel_arrow_link {
        width: 50px;
        height: 50px;
      }

      .carousel_arrow_link::before {
        border-width: 6px 10px 6px 0;
      }

      .carousel_arrow_link.is-right::before {
        border-width: 6px 0 6px 10px;
      }
    }

    @media screen and (max-width: 479px) {
      .carousel_arrow_link {
        width: 44px;
        height: 44px;
      }

      .carousel_arrow_wrap {
        gap: 0.5rem;
      }
    }

    .carousel_arrow_link::before {
      content: '';
      width: 0;
      height: 0;
      border-style: solid;
      border-width: 8px 12px 8px 0;
      border-color: transparent #fff transparent transparent;
      display: block;
    }

    .carousel_arrow_link.is-right::before {
      border-width: 8px 0 8px 12px;
      border-color: transparent transparent transparent #fff;
    }

    /* Disabled State */
    .swiper-button-disabled {
      pointer-events: none;
      opacity: 0.4;
    }

    /* Product Drawer Styles */
    .products_collection-drawer {
      z-index: 1000;
      display: none;
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .products_collection-drawer.open {
      display: flex;
    }

    .products_drawer-close {
      flex: 1;
      cursor: pointer;
    }

    .products_drawer-wrapper {
      border-left: 1px solid #666;
      background-color: #fff;
      color: #000;
      width: 50vw;
      max-width: 600px;
      padding-bottom: 3rem;
      padding-left: 1.5rem;
      padding-right: 3rem;
      overflow-y: auto;
      position: relative;
      animation: slideInRight 0.3s ease-out;
      /* Improve scrolling on mobile */
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
      }
      to {
        transform: translateX(0);
      }
    }

    @media screen and (max-width: 991px) {
      .products_drawer-wrapper {
        width: 85vw;
        max-width: none;
      }
    }

    @media screen and (max-width: 767px) {
      .products_drawer-wrapper {
        width: 85vw;
        max-width: none;
        padding-left: 1rem;
        padding-right: 1rem;
        padding-bottom: 2rem;
      }
    }

    @media screen and (max-width: 479px) {
      .products_drawer-wrapper {
        width: 100vw;
        padding-left: 0.75rem;
        padding-right: 0.75rem;
        padding-bottom: 1.5rem;
      }

      .products_drawer-title {
        margin-top: 2rem;
        padding-bottom: 0.5rem;
      }

      .products_drawer-title h3 {
        font-size: 1.25rem;
      }
    }

    .products_drawer-close-icon {
      width: 44px;
      height: 44px;
      min-width: 44px;
      min-height: 44px;
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 2rem;
      line-height: 1;
      color: #000;
      cursor: pointer;
      z-index: 10;
      transition: opacity 0.3s ease, transform 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      /* Touch-friendly */
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      padding: 0;
    }

    .products_drawer-close-icon:hover {
      opacity: 0.6;
    }

    .products_drawer-close-icon:active {
      transform: scale(0.9);
    }

    .products_drawer-title {
      border-bottom: 1px solid #666;
      justify-content: space-between;
      margin-top: 3.5rem;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      display: flex;
      align-items: baseline;
    }

    .products_drawer-title h3 {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
      color: #000;
    }

    .products_drawer-title h3:last-child {
      font-weight: 400;
      color: #666;
    }

    .products_drawer-content {
      grid-column-gap: 1.5rem;
      grid-row-gap: 1.5rem;
      grid-template-rows: auto;
      grid-template-columns: 1fr 1fr;
      grid-auto-columns: 1fr;
      align-items: start;
      height: auto;
      display: grid;
    }

    @media screen and (max-width: 767px) {
      .products_drawer-content {
        grid-template-columns: 1fr;
        grid-row-gap: 1rem;
      }

      .products_drawer-text {
        position: static;
      }
    }

    .products_drawer-images {
      grid-column-gap: 1.5rem;
      grid-row-gap: 1.5rem;
      grid-template-rows: auto auto;
      grid-template-columns: 1fr;
      grid-auto-columns: 1fr;
      display: grid;
    }

    .products_drawer-main-image {
      object-fit: cover;
      width: 100%;
      height: auto;
      max-height: 22rem;
      border-radius: 8px;
      /* Prevent image drag on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: none;
    }

    @media screen and (max-width: 767px) {
      .products_drawer-main-image {
        max-height: 18rem;
      }
    }

    @media screen and (max-width: 479px) {
      .products_drawer-main-image {
        max-height: 15rem;
      }
    }

    .products_drawer-more-collection {
      grid-column-gap: 1rem;
      grid-row-gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      display: grid;
    }

    .products_drawer-more-item {
      max-height: 100px;
      overflow: hidden;
      border-radius: 4px;
      cursor: pointer;
      transition: opacity 0.3s ease;
    }

    .products_drawer-more-item:hover {
      opacity: 0.7;
    }

    .products_drawer-more-image {
      object-fit: cover;
      width: 100%;
      height: 100%;
      /* Prevent image drag on mobile */
      -webkit-user-drag: none;
      user-select: none;
      pointer-events: auto;
    }

    @media screen and (max-width: 479px) {
      .products_drawer-more-item {
        max-height: 80px;
      }
    }

    .products_drawer-text {
      padding-top: 1.5rem;
      position: sticky;
      top: 1.5rem;
    }

    .products_quantity-wrapper {
      margin-bottom: 1rem;
    }

    .margin-bottom.margin-xsmall {
      margin-bottom: 0.5rem;
    }

    .uppercase {
      text-transform: uppercase;
      font-size: 0.875rem;
      font-weight: 600;
      color: #000;
      letter-spacing: 0.05em;
    }

    .products_quantity {
      border: 1px solid #ccc;
      background-color: #fff;
      text-align: center;
      border-radius: 4px;
      width: 80px;
      padding: 0.5rem;
      font-size: 1rem;
    }

    .button-secondary {
      border: 1px solid #000;
      background-color: #000;
      color: #fff;
      text-align: center;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      border-radius: 4px;
      padding: 0.75rem 2rem;
      font-size: 0.875rem;
      font-weight: 600;
      transition: all 0.3s ease;
      cursor: pointer;
      width: 100%;
      margin-top: 1rem;
      /* Touch-friendly */
      min-height: 44px;
      min-width: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .button-secondary:hover {
      background-color: #333;
      border-color: #333;
    }

    .button-secondary:active {
      transform: scale(0.98);
      background-color: #555;
    }

    /* Mobile button adjustments */
    @media screen and (max-width: 767px) {
      .button-secondary {
        padding: 0.625rem 1.5rem;
        font-size: 0.8rem;
      }
    }

    .products_text-top {
      border-bottom: 1px solid #ccc;
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
    }

    .products_out-of-stock,
    .products_error {
      background-color: #f5f5f5;
      color: #d32f2f;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }

    .products_text-bottom {
      margin-top: 1.5rem;
    }

    .margin-bottom.margin-medium {
      margin-bottom: 1rem;
    }

    .products_description-item {
      border-bottom: 1px solid #ccc;
      padding-top: 0.75rem;
      padding-bottom: 0.75rem;
      position: relative;
    }

    .products_description-item:last-child {
      border-bottom: none;
    }

    .products_description-question {
      justify-content: space-between;
      align-items: center;
      padding-top: 0;
      padding-bottom: 0;
      display: flex;
      cursor: pointer;
      /* Touch-friendly */
      min-height: 44px;
      padding: 0.5rem 0;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .products_description-question:hover {
      opacity: 0.7;
    }

    .products_description-question:active {
      opacity: 0.5;
    }

    .products_description-left {
      align-items: center;
      display: flex;
    }

    .products_description-icon {
      width: 1.25rem;
      height: 1.25rem;
      margin-right: 0.5rem;
      font-size: 1.25rem;
      line-height: 1;
    }

    .products_description-question p {
      margin: 0;
      font-weight: 500;
      color: #000;
    }

    .product_description-plus {
      font-size: 1.5rem;
      font-weight: 300;
      color: #000;
      transition: transform 0.3s ease;
      line-height: 1;
    }

    .products_description-item.active .product_description-plus {
      transform: rotate(45deg);
    }

    .products_description-answer {
      display: none;
      padding-top: 0.75rem;
      color: #666;
    }

    .products_description-item.active .products_description-answer {
      display: block;
    }

    .products_description-answer .paragraph {
      color: #666;
      line-height: 1.6;
    }

    .drawer-loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #fff;
      z-index: 1001;
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .drawer-loading p {
      margin: 0;
      font-size: 0.875rem;
    }
  </style>
</head>
<body>
  <!-- 3D Carousel Component -->
  <div carousel="component" class="carousel_component">
    
    <!-- 3D Image Carousel -->
    <div carousel="wrap" class="carousel_wrap">
      <div class="carousel_list">
        <!-- Carousel Items - Images will be loaded dynamically -->
        <div class="carousel_item" data-product-index="0">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product+001" alt="Product 001" class="carousel_img" loading="eager">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product+002" alt="Product 002" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 003" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 004" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 005" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 006" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 007" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 008" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 009" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 010" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 011" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 012" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 013" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 014" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 015" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
        <div class="carousel_item">
          <img src="https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product 016" class="carousel_img">
          <div class="carousel_ratio"></div>
        </div>
      </div>
    </div>

    <!-- Swiper Slider for Titles -->
    <div fade-up="" class="swiper">
      <div class="swiper-wrapper">
        <!-- Slides - Add your titles here -->
        <!-- Add data-product-handle attribute with your Shopify product handle -->
        <div class="swiper-slide" data-product-handle="product-handle-1">
          <h2>Product 001</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-2">
          <h2>Product 002</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-3">
          <h2>Product 003</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-4">
          <h2>Product 004</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-5">
          <h2>Product 005</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-6">
          <h2>Product 006</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-7">
          <h2>Product 007</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-8">
          <h2>Product 008</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-9">
          <h2>Product 009</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-10">
          <h2>Product 010</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-11">
          <h2>Product 011</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-12">
          <h2>Product 012</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-13">
          <h2>Product 013</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-14">
          <h2>Product 014</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-15">
          <h2>Product 015</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
        <div class="swiper-slide" data-product-handle="product-handle-16">
          <h2>Product 016</h2>
          <a href="#" class="button view-details-btn">view details</a>
        </div>
      </div>
    </div>

    <!-- Navigation Arrows -->
    <div fade-up="" class="carousel_arrow_wrap">
      <a carousel="prev" href="#" class="carousel_arrow_link"></a>
      <a carousel="next" href="#" class="carousel_arrow_link is-right"></a>
    </div>
  </div>

  <!-- Product Drawer -->
  <div class="products_collection-drawer" id="product-drawer">
    <div class="products_drawer-close" id="drawer-close-overlay"></div>
    <div class="products_drawer-wrapper">
      <button class="products_drawer-close-icon" id="drawer-close-btn" aria-label="Close drawer">√ó</button>
      
      <div class="products_drawer-title">
        <h3 id="drawer-product-title"></h3>
        <h3 id="drawer-product-price"></h3>
      </div>
      
      <div class="products_drawer-content">
        <!-- Images Section -->
        <div class="products_drawer-images">
          <img src="" loading="lazy" alt="Product image" class="products_drawer-main-image" id="drawer-main-image">
          <div class="products_drawer-more-collection" id="drawer-gallery">
            <!-- Gallery images will be populated dynamically -->
          </div>
        </div>
        
        <!-- Product Details Section -->
        <div class="products_drawer-text">
          <div class="products_text-top">
            <div class="products_quantity-wrapper">
              <div class="margin-bottom margin-xsmall">
                <h4 class="uppercase">qty</h4>
              </div>
              <input type="number" pattern="^[0-9]+$" inputmode="numeric" id="drawer-quantity" name="quantity" min="1" class="products_quantity" value="1">
            </div>
            <button id="drawer-add-to-cart" class="button-secondary">Add to Cart</button>
            <div style="display:none" class="products_out-of-stock" id="drawer-out-of-stock">
              <div>This product is out of stock.</div>
            </div>
            <div style="display:none" class="products_error" id="drawer-error">
              <div>Error loading product details.</div>
            </div>
          </div>
          
          <div class="products_text-bottom">
            <div class="margin-bottom margin-medium">
              <h4 class="uppercase">product info</h4>
            </div>
            
            <!-- Description Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon">üìÑ</span>
                  <p>Description</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <div class="paragraph" id="drawer-description"></div>
              </div>
            </div>
            
            <!-- Care Instructions Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon">‚ÑπÔ∏è</span>
                  <p>Care Instructions</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <div class="paragraph" id="drawer-care-instructions"></div>
              </div>
            </div>
            
            <!-- Delivery Section -->
            <div class="products_description-item">
              <div class="products_description-question">
                <div class="products_description-left">
                  <span class="products_description-icon">üöö</span>
                  <p>Delivery</p>
                </div>
                <span class="product_description-plus">+</span>
              </div>
              <div class="products_description-answer" style="display:none;">
                <p id="drawer-delivery"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Loading Spinner -->
    <div class="drawer-loading" id="drawer-loading" style="display:none;">
      <div class="loading-spinner"></div>
      <p>Loading product details...</p>
    </div>
  </div>

  <!-- Scripts -->
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  
  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

  <!-- 3D Carousel Script -->
  <script>
    // Prevent scrolling on page, but allow on carousel and swiper containers
    document.addEventListener('DOMContentLoaded', function() {
      // Prevent scroll on window
      window.addEventListener('scroll', function(e) {
        // Allow scrolling within carousel component and swiper
        const target = e.target;
        if (!target.closest('[carousel="component"]') && 
            !target.closest('.swiper') &&
            !target.closest('.products_drawer-wrapper')) {
          e.preventDefault();
          window.scrollTo(0, 0);
        }
      }, { passive: false });
      
      // Prevent scroll on touch devices, but allow on scrollable containers
      document.addEventListener('touchmove', function(e) {
        // Allow touch events on scrollable containers
        const target = e.target;
        if (!target.closest('[carousel="component"]') && 
            !target.closest('.swiper') &&
            !target.closest('.products_drawer-wrapper') &&
            !target.closest('.products_collection-drawer')) {
          e.preventDefault();
        }
      }, { passive: false });
      
      // Prevent wheel scrolling on page, but allow on scrollable containers
      document.addEventListener('wheel', function(e) {
        // Allow wheel scrolling on scrollable containers
        const target = e.target;
        if (!target.closest('[carousel="component"]') && 
            !target.closest('.swiper') &&
            !target.closest('.products_drawer-wrapper')) {
          e.preventDefault();
        }
      }, { passive: false });
      
      // Lock body scroll (page itself)
      document.body.style.overflow = 'hidden';
      document.documentElement.style.overflow = 'hidden';
      
      // Prevent pull-to-refresh on mobile
      document.body.style.overscrollBehavior = 'none';
      document.documentElement.style.overscrollBehavior = 'none';
    });
    
    $(document).ready(function() {
      $("[carousel='component']").each(function () {
        let componentEl = $(this);
        let wrapEl = componentEl.find("[carousel='wrap']");
        let swiperEl = componentEl.find(".swiper");
        let itemEl = wrapEl.find(".carousel_item");
        let nextEl = componentEl.find("[carousel='next']");
        let prevEl = componentEl.find("[carousel='prev']");
        
        // Calculate rotation angle per item (360¬∞ / number of items)
        let rotateAmount = 360 / itemEl.length;
        
        // Calculate Z-distance for proper 3D perspective
        let zTranslate = 2 * Math.tan((rotateAmount / 2) * (Math.PI / 180));
        
        // Calculate translate values
        let negTranslate = `calc(var(--3d-carousel-item-width) / -${zTranslate} - var(--3d-carousel-gap))`;
        let posTranslate = `calc(var(--3d-carousel-item-width) / ${zTranslate} + var(--3d-carousel-gap))`;

        // Set perspective and Z-position
        wrapEl.css("--3d-carousel-z", negTranslate);
        wrapEl.css("perspective", posTranslate);
        
        // Position each item in 3D space
        // Items are centered at origin, then rotated and translated outward
        itemEl.each(function (index) {
          $(this).css({
            left: '50%',
            top: '50%',
            transform: `translate(-50%, -50%) rotateY(${rotateAmount * index}deg) translateZ(${posTranslate})`
          });
          
          // Ensure images load and are visible
          const img = $(this).find('.carousel_img');
          if (img.length) {
            img.on('load', function() {
              $(this).css({ opacity: 1, visibility: 'visible' });
            }).on('error', function() {
              console.error('Failed to load image:', $(this).attr('src'));
              // Try to reload or show placeholder
              $(this).css({ opacity: 1, visibility: 'visible', backgroundColor: '#333' });
            });
            
            // Force image to be visible if already loaded
            if (img[0].complete && img[0].naturalHeight !== 0) {
              img.css({ opacity: 1, visibility: 'visible' });
            }
          }
        });
        
        // OPTIONAL: Load images dynamically from Shopify or Supabase
        // Uncomment and configure if you want to fetch real product images
        /*
        loadCarouselImagesFromShopify();
        // OR
        loadCarouselImagesFromSupabase();
        */

        // Prevent touch events on carousel wrapper from moving the page on mobile
        wrapEl[0].addEventListener('touchstart', function(e) {
          // Only prevent if touching the carousel itself, not the Swiper slider
          if (!$(e.target).closest('.swiper').length) {
            e.stopPropagation();
          }
        }, { passive: true });
        
        wrapEl[0].addEventListener('touchmove', function(e) {
          // Prevent page scroll when touching carousel images
          if (!$(e.target).closest('.swiper').length) {
            e.stopPropagation();
          }
        }, { passive: true });
        
        wrapEl[0].addEventListener('touchend', function(e) {
          if (!$(e.target).closest('.swiper').length) {
            e.stopPropagation();
          }
        }, { passive: true });

        // INTRO ANIMATION
        let introTl = gsap.timeline({
          onComplete: () => {
            swiperCode();
          }
        });
        
        // Fade in
        introTl.to(wrapEl, { opacity: 1, duration: 0.3 });
        
        // Rotate from off-screen to position
        introTl.fromTo(
          wrapEl, 
          { 
            "--3d-carousel-rotate": 100,
            "--3d-carousel-rotate-x": -90
          }, 
          { 
            "--3d-carousel-rotate": 0,
            "--3d-carousel-rotate-x": -4,
            duration: 4, 
            ease: "power2.inOut" 
          }, 
          "<"
        );
        
        // Fade in titles and arrows
        introTl.to("[fade-up]", { opacity: 1 }, ">-0.3");

        function swiperCode() {
          // Create continuous rotation timeline
          let tl = gsap.timeline({ paused: true });
          tl.fromTo(
            wrapEl, 
            { "--3d-carousel-rotate": 0 }, 
            { 
              "--3d-carousel-rotate": -(360 - rotateAmount),
              duration: 30, 
              ease: "none" 
            }
          );

          // Progress tracker for syncing
          let progress = { value: 0 };

          // Initialize Swiper with mobile-friendly touch gestures
          const swiper = new Swiper(swiperEl[0], {
            effect: "creative",
            creativeEffect: {
              prev: {
                translate: [0, "-100%", 0],
                scale: 0.5,
                opacity: 0
              },
              next: {
                translate: [0, "100%", 0],
                scale: 0.5,
                opacity: 0
              }
            },
            // Touch and swipe settings for mobile
            grabCursor: true,
            touchRatio: 1,
            touchAngle: 45,
            simulateTouch: true,
            allowTouchMove: true,
            touchStartPreventDefault: false,
            touchMoveStopPropagation: false,
            // Swipe settings
            slidesPerView: 1,
            spaceBetween: 0,
            // Keyboard support
            keyboard: {
              enabled: true,
              onlyInViewport: true
            },
            // Mousewheel support (desktop)
            mousewheel: {
              enabled: true,
              eventsTarget: "[carousel='component']",
              sensitivity: 1,
              forceToAxis: true
            },
            speed: 500,
            // Navigation arrows
            navigation: {
              nextEl: nextEl[0],
              prevEl: prevEl[0],
              disabledClass: "swiper-button-disabled"
            },
            // Touch events
            touchEventsTarget: 'container',
            // Prevent clicks during swipe
            preventClicks: true,
            preventClicksPropagation: true,
            // Resistance when reaching edges
            resistance: true,
            resistanceRatio: 0.85
          });
          
          // Sync Swiper progress with 3D rotation
          swiper.on("progress", function (e) {
            gsap.to(progress, {
              value: e.progress,
              onUpdate: () => {
                tl.progress(progress.value);
              }
            });
          });

          // Update arrow states
          swiper.on("reachBeginning", function () {
            prevEl.addClass("swiper-button-disabled");
          });
          swiper.on("reachEnd", function () {
            nextEl.addClass("swiper-button-disabled");
          });
          swiper.on("fromEdge", function () {
            prevEl.removeClass("swiper-button-disabled");
            nextEl.removeClass("swiper-button-disabled");
          });
        }
      });
      
      // Function to load carousel images from Shopify
      async function loadCarouselImagesFromShopify() {
        const slides = $('.swiper-slide');
        slides.each(async function(index) {
          const handle = $(this).data('product-handle');
          if (handle && !handle.startsWith('product-handle-')) {
            try {
              const product = await fetchProduct(handle);
              if (product && product.images.edges.length > 0) {
                const imageUrl = product.images.edges[0].node.url;
                const carouselItem = $('.carousel_item').eq(index);
                carouselItem.find('.carousel_img').attr('src', imageUrl);
              }
            } catch (error) {
              console.error(`Failed to load image for ${handle}:`, error);
            }
          }
        });
      }
      
      // Function to load carousel images from Supabase
      async function loadCarouselImagesFromSupabase() {
        // Uncomment and configure if using Supabase
        /*
        const slides = $('.swiper-slide');
        const handles = slides.map(function() {
          return $(this).data('product-handle');
        }).get();
        
        try {
          const response = await fetch(
            `${SUPABASE_URL}/rest/v1/products?handle=in.(${handles.join(',')})&select=handle,primary_image`,
            {
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
              }
            }
          );
          const products = await response.json();
          
          products.forEach(product => {
            if (product.primary_image) {
              const slideIndex = handles.indexOf(product.handle);
              if (slideIndex !== -1) {
                const carouselItem = $('.carousel_item').eq(slideIndex);
                carouselItem.find('.carousel_img').attr('src', product.primary_image);
              }
            }
          });
        } catch (error) {
          console.error('Failed to load images from Supabase:', error);
        }
        */
      }
    });

    // Product Drawer Functionality
    $(document).ready(function() {
      const drawer = $('#product-drawer');
      const drawerOverlay = $('#drawer-close-overlay');
      const drawerCloseBtn = $('#drawer-close-btn');
      const viewDetailsBtns = $('.view-details-btn');
      
      // Shopify Storefront API Configuration
      // For production, move token to Cloudflare Pages environment variables
      // Note: If API calls fail, try using your myshopify.com domain (e.g., onlyatthekiosk.myshopify.com)
      const SHOPIFY_STORE = 'onlyatthekiosk.com';
      const SHOPIFY_TOKEN = '3c7e207a3167fe57edd75d8133a36967'; // TODO: Move to environment variable for production
      const SHOPIFY_API_URL = `https://${SHOPIFY_STORE}/api/2024-01/graphql.json`;
      
      // Supabase Configuration (optional - for custom image URLs)
      // Uncomment and configure if you want to fetch images from Supabase
      // const SUPABASE_URL = 'https://your-project.supabase.co';
      // const SUPABASE_ANON_KEY = 'your-anon-key';

      // GraphQL query to fetch product by handle
      function getProductQuery(handle) {
        return `
          query getProduct($handle: String!) {
            product(handle: $handle) {
              id
              title
              description
              descriptionHtml
              priceRange {
                minVariantPrice {
                  amount
                  currencyCode
                }
              }
              images(first: 10) {
                edges {
                  node {
                    id
                    url
                    altText
                  }
                }
              }
              variants(first: 1) {
                edges {
                  node {
                    id
                    availableForSale
                    price {
                      amount
                      currencyCode
                    }
                  }
                }
              }
              metafields(identifiers: [
                {namespace: "custom", key: "care_instructions"}
                {namespace: "custom", key: "delivery"}
              ]) {
                id
                namespace
                key
                value
                type
              }
            }
          }
        `;
      }

      // Fetch product from Shopify Storefront API
      async function fetchProduct(handle) {
        try {
          const response = await fetch(SHOPIFY_API_URL, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-Shopify-Storefront-Access-Token': SHOPIFY_TOKEN
            },
            body: JSON.stringify({
              query: getProductQuery(handle),
              variables: { handle: handle }
            })
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          
          if (data.errors) {
            throw new Error(data.errors[0].message);
          }

          return data.data.product;
        } catch (error) {
          console.error('Error fetching product:', error);
          throw error;
        }
      }

      // Populate drawer with product data
      function populateDrawer(product) {
        // Product title and price
        $('#drawer-product-title').text(product.title);
        const price = product.priceRange.minVariantPrice;
        $('#drawer-product-price').text(`${price.amount} ${price.currencyCode}`);

        // Main image
        if (product.images.edges.length > 0) {
          const mainImage = product.images.edges[0].node;
          $('#drawer-main-image').attr('src', mainImage.url).attr('alt', mainImage.altText || product.title);
          
          // Gallery images
          const gallery = $('#drawer-gallery');
          gallery.empty();
          
          if (product.images.edges.length > 1) {
            product.images.edges.slice(1).forEach(({ node: image }) => {
              const galleryItem = $('<div class="products_drawer-more-item"></div>');
              const galleryImg = $('<img class="products_drawer-more-image" loading="lazy">');
              galleryImg.attr('src', image.url).attr('alt', image.altText || product.title);
              galleryItem.append(galleryImg);
              galleryItem.on('click', () => {
                $('#drawer-main-image').attr('src', image.url).attr('alt', image.altText || product.title);
              });
              gallery.append(galleryItem);
            });
          }
        }

        // Description
        if (product.descriptionHtml) {
          $('#drawer-description').html(product.descriptionHtml);
        } else if (product.description) {
          $('#drawer-description').text(product.description);
        } else {
          $('#drawer-description').text('No description available.');
        }

        // Care instructions (from metafield)
        const careInstructionsMetafield = product.metafields?.find(m => m.key === 'care_instructions');
        if (careInstructionsMetafield) {
          if (careInstructionsMetafield.type === 'rich_text_field' || careInstructionsMetafield.type === 'multi_line_text_field') {
            $('#drawer-care-instructions').html(careInstructionsMetafield.value);
          } else {
            $('#drawer-care-instructions').text(careInstructionsMetafield.value);
          }
        } else {
          $('#drawer-care-instructions').html('<p>Care instructions not available.</p>');
        }

        // Delivery (from metafield or default)
        const deliveryMetafield = product.metafields?.find(m => m.key === 'delivery');
        if (deliveryMetafield) {
          $('#drawer-delivery').html(deliveryMetafield.value);
        } else {
          $('#drawer-delivery').text('Standard delivery information will be displayed here.');
        }

        // Stock status
        const isAvailable = product.variants.edges[0]?.node.availableForSale || false;
        if (!isAvailable) {
          $('#drawer-out-of-stock').show();
          $('#drawer-add-to-cart').prop('disabled', true);
        } else {
          $('#drawer-out-of-stock').hide();
          $('#drawer-add-to-cart').prop('disabled', false);
        }

        // Hide error if previously shown
        $('#drawer-error').hide();
      }

      // Fetch image from Supabase (optional - if you store image URLs in Supabase)
      async function fetchImageFromSupabase(productHandle) {
        try {
          // Uncomment and configure if using Supabase
          /*
          const response = await fetch(
            `${SUPABASE_URL}/rest/v1/products?handle=eq.${productHandle}&select=primary_image`,
            {
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
              }
            }
          );
          const data = await response.json();
          if (data && data.length > 0 && data[0].primary_image) {
            return data[0].primary_image;
          }
          */
          return null;
        } catch (error) {
          console.error('Error fetching image from Supabase:', error);
          return null;
        }
      }

      // Placeholder product data for template products
      // Each product handle corresponds to a carousel slide
      function getPlaceholderProduct(productHandle) {
        // IMAGE SOURCE OPTIONS (choose one):
        
        // Option 1: Placeholder service (fast, no hosting, good for testing)
        const placeholderImage = 'https://via.placeholder.com/800x800/1a1a1a/ffffff?text=Product+Placeholder';
        
        // Option 2: Unsplash (free, high-quality, good for demos)
        // const placeholderImage = 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=800&h=800&fit=crop&auto=format';
        
        // Option 3: Your hosted placeholder (if optimized to <500KB)
        // const placeholderImage = '/images/kiosk-placeholder-product-img.png';
        
        // Option 4: Cloudinary or other CDN (best for production)
        // const placeholderImage = 'https://res.cloudinary.com/your-cloud/image/upload/w_800,h_800,c_fill/product-placeholder.jpg';
        
        // Option 5: Fetch from Supabase (async - see fetchImageFromSupabase above)
        // This would require making the function async and awaiting the result
        
        // Generate product titles (Product 001, Product 002, etc.)
        const productTitles = [];
        for (let i = 1; i <= 16; i++) {
          const num = i.toString().padStart(3, '0');
          productTitles.push(`Product ${num}`);
        }
        
        const productPrices = ['299.00', '349.00', '379.00', '399.00', '429.00', '449.00', '479.00', '499.00', '529.00', '549.00', '579.00', '599.00', '629.00', '649.00', '679.00', '699.00'];
        
        // Extract product index from handle (e.g., 'product-handle-1' -> 0)
        const handleMatch = productHandle.match(/product-handle-(\d+)/);
        const index = handleMatch ? parseInt(handleMatch[1]) - 1 : 0;
        const title = productTitles[index] || 'Product 001';
        const price = productPrices[index] || '299.00';

        // Use placeholder image for main image and gallery
        // You can add multiple gallery images later if needed
        const galleryImages = [
          placeholderImage,
          placeholderImage,
          placeholderImage
        ];

        return {
          title: title,
          price: { amount: price, currencyCode: 'SEK' },
          mainImage: placeholderImage,
          gallery: galleryImages,
          description: `<p>${title} is a premium product designed for the modern lifestyle. Crafted with cutting-edge technology and attention to detail, this item represents the perfect blend of style and functionality. Each piece is carefully selected and designed to meet the highest standards of quality.</p><p>Experience the difference with ${title} - where innovation meets timeless design.</p>`,
          careInstructions: '<p><strong>Care Instructions:</strong></p><ul><li>Hand wash recommended in cold water</li><li>Do not bleach or use harsh detergents</li><li>Lay flat to dry</li><li>Iron on low heat if needed</li><li>Store in a cool, dry place</li><li>Keep away from direct sunlight when storing</li></ul>'
        };
      }

      // Populate drawer with placeholder data
      function populatePlaceholderDrawer(placeholderData) {
        // Product title and price
        $('#drawer-product-title').text(placeholderData.title);
        $('#drawer-product-price').text(`${placeholderData.price.amount} ${placeholderData.price.currencyCode}`);

        // Main image
        $('#drawer-main-image').attr('src', placeholderData.mainImage).attr('alt', placeholderData.title);
        
        // Gallery images
        const gallery = $('#drawer-gallery');
        gallery.empty();
        
        if (placeholderData.gallery && placeholderData.gallery.length > 0) {
          placeholderData.gallery.forEach((imageUrl, index) => {
            const galleryItem = $('<div class="products_drawer-more-item"></div>');
            const galleryImg = $('<img class="products_drawer-more-image" loading="lazy">');
            galleryImg.attr('src', imageUrl).attr('alt', `${placeholderData.title} - Image ${index + 2}`);
            galleryItem.append(galleryImg);
            galleryItem.on('click', () => {
              $('#drawer-main-image').attr('src', imageUrl).attr('alt', `${placeholderData.title} - Image ${index + 2}`);
            });
            gallery.append(galleryItem);
          });
        }

        // Description
        if (placeholderData.description) {
          $('#drawer-description').html(placeholderData.description);
        }

        // Care instructions
        if (placeholderData.careInstructions) {
          $('#drawer-care-instructions').html(placeholderData.careInstructions);
        }

        // Delivery (default for all)
        $('#drawer-delivery').html(`
          <strong>Delivery Information:</strong><br>
          Standard shipping: 5-7 business days<br>
          Express shipping: 2-3 business days<br>
          Free shipping on orders over $100<br>
          International shipping available<br>
          Track your order through our shipping partner
        `);

        // Hide error and out of stock
        $('#drawer-error').hide();
        $('#drawer-out-of-stock').hide();
        $('#drawer-add-to-cart').prop('disabled', false);
      }

      // Open drawer
      function openDrawer(productHandle) {
        drawer.addClass('open');
        $('body').css('overflow', 'hidden'); // Lock body scroll

        // Check if it's a placeholder handle
        if (productHandle && productHandle.startsWith('product-handle-')) {
          // Show placeholder data immediately
          const placeholderData = getPlaceholderProduct(productHandle);
          populatePlaceholderDrawer(placeholderData);
          return;
        }

        // Otherwise, fetch from Shopify
        $('#drawer-loading').show();
        fetchProduct(productHandle)
          .then(product => {
            populateDrawer(product);
            $('#drawer-loading').hide();
          })
          .catch(error => {
            console.error('Error loading product:', error);
            $('#drawer-loading').hide();
            $('#drawer-error').show().find('div').text('Failed to load product details. Please try again.');
          });
      }

      // Close drawer
      function closeDrawer() {
        drawer.removeClass('open');
        $('body').css('overflow', ''); // Unlock body scroll
      }

      // Event handlers
      viewDetailsBtns.on('click', function(e) {
        e.preventDefault();
        const slide = $(this).closest('.swiper-slide');
        const productHandle = slide.data('product-handle');
        
        if (productHandle) {
          openDrawer(productHandle);
        } else {
          alert('Product handle not found. Please add data-product-handle attribute.');
        }
      });

      drawerCloseBtn.on('click', closeDrawer);
      drawerOverlay.on('click', closeDrawer);

      // Close drawer on ESC key
      $(document).on('keydown', function(e) {
        if (e.key === 'Escape' && drawer.hasClass('open')) {
          closeDrawer();
        }
      });

      // Accordion functionality for description sections
      $('.products_description-question').on('click', function() {
        const item = $(this).closest('.products_description-item');
        const isActive = item.hasClass('active');
        
        // Close all items
        $('.products_description-item').removeClass('active');
        
        // Open clicked item if it wasn't active
        if (!isActive) {
          item.addClass('active');
        }
      });

      // Add to cart button (placeholder - integrate with your cart system)
      $('#drawer-add-to-cart').on('click', function() {
        // TODO: Integrate with Shopify cart or your checkout system
        alert('Add to cart functionality will be integrated with Shopify checkout.');
      });
    });
  </script>
</body>
</html>

